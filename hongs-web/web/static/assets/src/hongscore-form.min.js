function HsForm(c,a){c=jQuery(c);var r=c.closest(".loadbox");var p=c.find(".pagebox");var l=c.find("form");var h=hsGetValue(a,"loadUrl");var m=hsGetValue(a,"saveUrl");var f=hsGetValue(a,"loadData");var e=hsGetValue(a,"initData");var o=hsGetValue(a,"idKey","id");var t=hsGetValue(a,"abKey","ab");if(!l.length){l=c}this.context=c;this.loadBox=r;this.pageBox=p;this.formBox=l;this._url="";this._data=[];this._opt_group_start="#";if(a){for(var g in a){if("_"===g.substring(0,1)||this[g]!==undefined){this[g]=a[g]}else{if("@"===g.substring(0,1)){var d=g.substring(1);this.rules["[name="+d+"]"]=a[g]}else{if("$"===g.substring(0,1)){this.rules[g.substring(1)]=a[g]}else{if(":"===g.substring(0,1)){this.rmsgs[g.substring(1)]=a[g]}}}}}}var q=hsSerialArr(r);if(h){h=hsFixPms(h,q)}if(m){m=hsFixPms(m,q);this.formBox.attr("action",m)}if(!f){var b=hsGetParam(h,o);if(!b){b=hsGetSeria(q,o);f={};f[o]=b}}if(e){e=hsSerialDic(e)}else{e=hsSerialDic([]);for(var j=0;j<q.length;j++){var d=q[j];if(d.name&&(d.value||d.value===0)){var s=d.value;var g=d.name;g=_hsGetDkeys(g);_hsSetPoint(e,g,s)}}}this._init=e;this.valiInit();this.saveInit();if(h&&(hsGetParam(h,o)||hsGetParam(h,t))){this.load(h,f)}else{if(!this._url){this.loadBack({})}}}HsForm.prototype={load:function(a,b){b=hsSerialObj(b);if(a){this._url=a}if(b){this._data=b}this.ajax({url:this._url,data:this._data,type:"POST",dataType:"json",funcName:"load",cache:false,global:false,context:this,complete:this.loadBack})},loadBack:function(h){h=hsResponse(h);if(h.ok===false){return}this.formBox.trigger("loadBack",[h,this]);var c=h.page||{};var g=h.enfo||{};var e=h.info||(h.list&&h.list[0])||{};if(this._init){var f=hsSerialDic(this._init);for(var b in f){var a=f[b];b=b.replace(/(\[\]|\.)$/,"");hsSetValue(e,b,a)}}this.fillEnfo(g);this.fillInfo(e);this.fillPage(c);this.formBox.trigger("loadOver",[h,this])},fillEnfo:function(enfo){var fds,fns,fts,fls,i,n,t,v,f;fds=this.formBox.find("[data-fn],input[name],select[name],textarea[name]").not(".form-ignored");fns={};fts={};fls={};for(i=0;i<fds.length;i++){v=jQuery(fds[i]);n=v.attr("name");if(!n){n=v.data("fn")}if(!n){continue}fns[n]=n;fts[n]=v.data("ft");f=v.data("dl");if(f&&typeof f!="function"){try{f=eval("(null||function(form,v,n){return "+f+";})")}catch(e){throw new Error("Parse form data-dl error: "+e)}v.data("dl",f)}if(f){fls[n]=f}}this._enfo=enfo;for(n in fns){t=fts[n];f=fls[n];v=hsGetValue(enfo,n.replace(/(\[\]|\.)$/,""));if(v===undefined){v=enfo[n]}i=this.formBox.find('[name="'+n+'"]').not(".form-ignored");if(i.length===0){i=this.formBox.find('[data-fn="'+n+'"]').not(".form-ignored")}if(f){v=f.call(i[0],this,v,n)}if(n&&this["_doll_"+n]!==undefined){v=this["_doll_"+n].call(this,i,v,n)}else{if(t&&this["_doll_"+t]!==undefined){v=this["_doll_"+t].call(this,i,v,n)}}if(!v&&v!==0&&v!==""){continue}if(i.is("select")){this._doll__select(i,v,n)}else{this._doll__review(i,v,n)}}delete this._enfo},fillInfo:function(info){var fds,fns,fts,fls,i,n,t,v,f;fds=this.formBox.find("[data-fn],input[name],select[name],textarea[name]").not(".form-ignored");fns={};fts={};fls={};for(i=0;i<fds.length;i++){v=jQuery(fds[i]);n=v.attr("name");if(!n){n=v.data("fn")}if(!n){continue}fns[n]=n;fts[n]=v.data("ft");f=v.data("fl");if(f&&typeof f!="function"){try{f=eval("(null||function(form,v,n){return "+f+";})")}catch(e){throw new Error("Parse form data-fl error: "+e)}v.data("fl",f)}if(f){fls[n]=f}}this._info=info;for(n in fns){t=fts[n];f=fls[n];v=hsGetValue(info,n.replace(/(\[\]|\.)$/,""));if(v===undefined){v=info[n]}i=this.formBox.find('[name="'+n+'"]').not(".form-ignored");if(i.length===0){i=this.formBox.find('[data-fn="'+n+'"]').not(".form-ignored");if(t===undefined){t="_review"}}if(f){v=f.call(i[0],this,v,n)}if(n&&this["_fill_"+n]!==undefined){v=this["_fill_"+n].call(this,i,v,n)}else{if(t&&this["_fill_"+t]!==undefined){v=this["_fill_"+t].call(this,i,v,n)}}if(!v&&v!==0&&v!==""){continue}if(i.attr("type")=="checkbox"||i.attr("type")=="radio"){jQuery.each(!jQuery.isArray(v)?[v]:v,function(j,u){i.filter("[value='"+u+"']").prop("checked",true).change()})}else{if(i.attr("type")=="file"){i.attr("data-value",v).change()}else{if(i.is("input,select,textarea")){i.val(v).change()}else{i.text(v)}}}}delete this._info},fillPage:function(a){var c=this.formBox;var b=this.pageBox;if(a.state===undefined||a.state===null||a.state>0){c.show();b.hide()}else{if(b.size()){c.hide();b.show();if(a.count&&a.count>0){b.empty().append('<div class="alert alert-warning" style="width: 100%;">'+(this._above_err||hsGetLang("info.above"))+"</div>")}else{b.empty().append('<div class="alert alert-warning" style="width: 100%;">'+(this._empty_err||hsGetLang("info.empty"))+"</div>")}}else{if(a.count&&a.count>0){jQuery.hsWarn(this._above_err||hsGetLang("info.above"),"warning")}else{jQuery.hsWarn(this._empty_err||hsGetLang("info.empty"),"warning")}}}},saveInit:function(){var a=this;this.formBox.submit(function(b){if(b.isDefaultPrevented()){return}if(a._waiting){a.note(hsGetLang("form.waiting"));b.preventDefault();return}a._waiting=true;var g=a.formBox;var c=g.attr("action");var e=g.attr("method")||"POST";var h=g.attr("enctype")||"None";if(/^.*\/json($|;| )/i.test(h)){b.preventDefault();var f=hsAsFormData(g[0]);var d=jQuery.Event("willSave");g.trigger(d,[f,a]);if(d.isDefaultPrevented()){delete a._waiting;return}a.save(c,f,e,"json")}else{if(!/^multipart\/.*/i.test(h)){b.preventDefault();var f=hsAsFormData(g[0]);var d=jQuery.Event("willSave");g.trigger(d,[f,a]);if(d.isDefaultPrevented()){delete a._waiting;return}a.save(c,f,e,"form")}else{if(window.FormData){b.preventDefault();var f=hsToFormData(g[0]);var d=jQuery.Event("willSave");g.trigger(d,[f,a]);if(d.isDefaultPrevented()){delete a._waiting;return}a.save(c,f,e,"part")}else{var f=hsBeFormData(g[0]);var d=jQuery.Event("willSave");g.trigger(d,[f,a]);if(d.isDefaultPrevented()){b.preventDefault();delete a._waiting;return}a.swap(c,g)}}}})},saveBack:function(b){b=hsResponse(b,1);if(b.ok){var a=jQuery.Event("saveBack");this.formBox.trigger(a,[b,this]);if(a.isDefaultPrevented()){return}this.loadBox.hsClose();if(b.msg){this.note(b.msg,"success")}}else{var a=jQuery.Event("saveFail");this.formBox.trigger(a,[b,this]);if(a.isDefaultPrevented()){return}this.seterror(b.errs||{});if(b.msg){this.warn(b.msg,"warning")}else{if(!b.errs){this.warn(hsGetLang("error.unkwn"))}}}},swap:function(c,f){if(!f.attr("target")){var e=this;var a=hsSetParam(c,".ajax","1");var b="_"+((new Date()).getTime()%86400000)+"_"+Math.floor(Math.random()*1000);var d="width:0; height:0; border:0; margin:0; padding:0; overflow:hidden; visibility:hidden;";var g=jQuery('<iframe src="about:blank" name="'+b+'" style="'+d+'"></iframe>');g.insertBefore(f);f.attr("target",b);f.attr("action",a);g.on("load",function(){var h=g[0].contentDocument||g[0].contentWindow.document;if(h.location.href==="about:blank"){return}var i=h.body.innerHTML.replace(/(^<PRE.*?>|<\/PRE>$)/igm,"");delete e._waiting;e.saveBack(i)})}},save:function(a,d,c,b){this.ajax({url:a,data:d,type:c,dataKind:b,dataType:"json",funcName:"save",async:false,cache:false,global:false,context:this,trigger:this.formBox,complete:function(e){delete this._waiting;this.saveBack(e)}})},ajax:function(){return jQuery.hsAjax.apply(window,arguments)},note:function(){return jQuery.hsNote.apply(window,arguments)},warn:function(){return jQuery.hsWarn.apply(window,arguments)},_fill__review:function(l,q,b){if(q===undefined||q===null){return}if(l.is("a,img,video,audio")){var r=!q?q:hsFixUri(q);l.filter("a:empty").text(q);l.filter("a").attr("href",r);l.filter("a.a-email").attr("href","mailto:"+q);l.filter("a.a-tel").attr("href","tel:"+q);l.filter("a.a-sms").attr("href","sms:"+q);l.filter("img,video,audio").attr("src",r);return}if(l.is("ul,ol,.repeated,.multiple")){var f=l.attr("data-vk")||0;var s=l.attr("data-tk")||1;var o=l.data("data")||[];var p=jQuery(l.is("ul,ol")?"<li></li>":"<div></div>");var d={};var g,j,h;p.attr("class",l.attr("data-item-class"));p.attr("style",l.attr("data-item-style"));l.empty();if(!jQuery.isArray(q)){q=[q]}for(g=0;g<o.length;g++){j=o[g];d[j[s]]=j[f]}for(g=0;g<q.length;g++){j=q[g];if(jQuery.isPlainObject(j)||jQuery.isArray(j)){h=j[s];j=j[f]}else{h=d[j];if(h===undefined){h=j}}p.text(h);p.attr("title",h);p.attr("data-code",j);l.append(p.clone())}return}return q},_doll__review:function(b,a,c){b.data("data",a);return a},_doll__select:function(f,g,b){if(g===undefined){return}var c=f.attr("data-vk");if(!c){c=0}var j=f.attr("data-tk");if(!j){j=1}for(var e=0;e<g.length;e++){var d=hsGetValue(g[e],c);var h=hsGetValue(g[e],j);if(d&&this._opt_group_start&&d[0]==this._opt_group_start){if(f.is("optgroup")){f=f.parent()}f=jQuery("<optgroup></optgroup>").appendTo(f);f.attr("label",h).attr("data-value",d);continue}var a=jQuery("<option></option>");a.val(d).text(h).data("data",g[e]);f.append(a)}if(f.closest(".form-group").hasClass("has-error")){f.change()}},_doll__radio:function(f,h,a){if(h===undefined){return}var b=f.attr("data-vk");if(!b){b=0}var l=f.attr("data-tk");if(!l){l=1}for(var d=0;d<h.length;d++){var c=hsGetValue(h[d],b);var j=hsGetValue(h[d],l);if(c&&this._opt_group_start&&c[0]==this._opt_group_start){if(f.is("fieldset")){f=f.parent()}var g;f=jQuery("<optgroup></optgroup>").appendTo(f);g=jQuery("<legend></legend>").appendTo(f);g.text(j);f.attr("data-value",c);continue}var e=jQuery('<label><input type="radio"   /><span></span></label>');e.find("input").val(c).attr("name",a).data("data",h[d]);e.find("span").text(j);f.append(e)}if(f.closest(".form-group").hasClass("has-error")){f.find("input").first().change()}},_doll__check:function(f,h,a){if(h===undefined){return}var b=f.attr("data-vk");if(!b){b=0}var l=f.attr("data-tk");if(!l){l=1}for(var d=0;d<h.length;d++){var c=hsGetValue(h[d],b);var j=hsGetValue(h[d],l);if(c&&this._opt_group_start&&c[0]==this._opt_group_start){if(f.is("fieldset")){f=f.parent()}var g;f=jQuery("<optgroup></optgroup>").appendTo(f);g=jQuery("<legend></legend>").appendTo(f);g.text(j);f.attr("data-value",c);continue}var e=jQuery('<label><input type="checkbox"/><span></span></label>');e.find("input").val(c).attr("name",a).data("data",h[d]);e.find("span").text(j);f.append(e)}if(f.closest(".form-group").hasClass("has-error")){f.find("input").first().change()}},_doll__checkset:function(k,o,b){if(o===undefined){return}var d=k.attr("data-vk");if(!d){d=0}var t=k.attr("data-tk");if(!t){t=1}var c=k.attr("data-vl");if(!c){c=0}var q=k.attr("data-tl");if(!q){q=1}var h=k.attr("data-body-class")||"checkbox";var a=k.attr("data-item-class")||"col-xs-6";for(var f=0;f<o.length;f++){var p=o[f][c];var r=o[f][q];var m=jQuery('<fieldset><legend data-toggle="hsDrop"><input  type="checkbox" class="checkall"/><b></b> <i class="caret"></i></legend><div class="dropdown-body clearfix"></div></fieldset>');k.append(m);m.find("b").text(r);m=m.find("div").addClass(h);for(var e=0;e<p.length;e++){var l=p[e];var g=jQuery('<label class="'+a+'"><input type="checkbox"/><span></span></label>');g.find("input").attr("name",b).data(l).val(hsGetValue(l,d));g.find("span").text(hsGetValue(l,t));m.append(g)}}if(k.closest(".form-group").hasClass("has-error")){k.find("input").first().change()}k.hsReady()},_fill__htime:function(e,a,d){if(a===undefined){return a}var c=new Date();var b=hsPrsDate(a,hsGetLang("datetime.format"));if(c.getFullYear()==b.getFullYear()&&c.getMonth()==b.getMonth()&&c.getDate()==b.getDate()){return hsGetLang("time.today",[hsFmtDate(a,hsGetLang("time.format"))])}else{return hsFmtDate(a,hsGetLang("date.format"))}},_fill__hdate:function(e,a,d){if(a===undefined){return a}var c=new Date();var b=hsPrsDate(a,hsGetLang("date.format"));if(c.getFullYear()==b.getFullYear()&&c.getMonth()==b.getMonth()&&c.getDate()==b.getDate()){return hsGetLang("date.today")}else{return hsFmtDate(a,hsGetLang("date.format"))}},_fill__datetime:function(c,a,b){if(a===undefined){return a}return hsFmtDate(a,hsGetLang("datetime.format"))},_fill__date:function(c,a,b){if(a===undefined){return a}return hsFmtDate(a,hsGetLang("date.format"))},_fill__time:function(c,a,b){if(a===undefined){return a}return hsFmtDate(a,hsGetLang("time.format"))},_fill__html:function(c,a,b){if(a===undefined){return a}jQuery(c).html(a);return false},_fill__text:function(c,a,b){if(a===undefined){return a}jQuery(c).text(a);return false},valiInit:function(){var a=this;this.formBox.attr("novalidate","novalidate");this.formBox.on("reset",function(b){if(b.isDefaultPrevented()){return}return a.verified()});this.formBox.on("submit",function(b){if(b.isDefaultPrevented()){return}return a.verifies()});this.formBox.on("change","input,select,textarea,[data-fn]",function(){var c=jQuery(this);var b=c.attr("name")||c.attr("data-fn");if(b){a.validate(b)}})},verified:function(){this.formBox.find(".form-group").removeClass("has-error").find(".text-error").empty();return true},verifies:function(){this.verified();var b=true;var a={};this.formBox.find("input,select,textarea,[data-fn]").not(".form-ignored").each(function(){var e=jQuery(this);var f=e.attr("name")||e.attr("data-fn");if(!f){return true}if(a[f]===undefined){a[f]=e}else{a[f]=a[f].add(e)}});for(var c in a){var d=this.validate(a[c]);if(d==false){b=false}}if(!b){this.warn(hsGetLang("form.invalid"),"warning")}return b},validate:function(c){if(c===undefined){return this.verifies()}var d;c=this.getinput(c);d=this.getvalue(c);for(var a in this.rules){if(!c.is(a)){continue}var b=this.rules[a].call(this,d,c);if(b!==true){b=b||hsGetLang("form.haserror");this.seterror(c,b);return false}else{this.seterror(c)}}return true},seterror:function(f,d){if(d===undefined&&jQuery.isPlainObject(f)){this.verified();for(var h in f){var g=f[h];this.seterror(h,g)}return}f=this.getinput(f);var a=f.closest(".form-group");var c=a.find(".text-error");var b=a.find(".control-label");if(c.size()==0){c=jQuery('<p class="text-error help-block"></p>').appendTo(a);if(b.hasClass(".form-control-static")){c.addClass("form-control-static")}}if(d===undefined){a.removeClass("has-error");c.addClass("invisible")}else{a.addClass("has-error");c.removeClass("invisible");c.text(d)}},geterror:function(d,c,e){var f=c.replace(/^form\./,"").replace(/\./g,"-");f=d.attr("data-"+f+"-error")||d.attr("data-error");if(f){c=f}if(this.rmsgs[c]){c=this.rmsgs[c]}var b=d.attr("data-label");if(b==null){b=d.closest(".form-group").find(".control-label").text()}if(b){if(jQuery.isArray(e)){var g={};for(var a=0;a<e.length;a++){g[a+""]=e[a]}e=g}else{if(e==null){e={}}}e._=hsGetLang(b)}return hsGetLang(c,e)},getinput:function(c){if(typeof c!="string"){return jQuery(c)}do{var d=c;c=this.formBox.find('[name="'+d+'"],[data-fn="'+d+'"]');if(c.size()){break}var b=/^(.*)\[(\d+)\]$/.exec(d);if(b==null){break}var a=b[2];d=b[1];c=this.formBox.find('[name="'+d+'"],[data-fn="'+d+'"]');if(c.size()){return c.eq(parseInt(a))}c=this.formBox.find('[name="'+d+'."],[data-fn="'+d+'."]');if(c.size()){break}c=this.formBox.find('[name="'+d+'[]"],[data-fn="'+d+'[]"]');if(c.size()){break}}while(false);return c.not(".form-ignored")},getvalue:function(a){if(a.is("input,select,textarea")===false){a=a.find("input")}if(a.is(":checkbox")){var b=[];a.filter(":checked").each(function(){b.push($(this).val())});return b}if(a.is(":radio")){return a.filter(":checked").last().val()}if(/(\[\]|\.\.|\.$)/.test(a.attr("name"))){var b=[];a.each(function(){b.push($(this).val())});return b}else{return a.last().val()}},rmsgs:{},rules:{"[required],[data-required]":function(d,c){if(c.is(":radio,:checkbox")){if(!c.filter(":checked").length){return this.geterror(c,"form.requires")}}else{if(c.is(".checkbox")){if(!c.find(":checked").length){return this.geterror(c,"form.requires")}}else{if(c.is("ul,div")){if(!c.find("input").length){return this.geterror(c,"form.requires")}}else{if(c.is(":file")){if(!d&&!c.data("value")){return this.geterror(c,"form.requires")}var a=c.filter(":hidden");var b=c.parent().closest(".file-input");if(!d&&!a.size()&&b.size()){return this.geterror(c,"form.requires")}}else{if(c.is("select")){if(!d){return this.geterror(c,"form.requires")}}else{if(!d){return this.geterror(c,"form.required")}}}}}}return true},"[pattern],[data-pattern]":function(d,c){var a=c.attr("pattern")||c.attr("data-pattern");var b=/^\/(.*)\/([gim])?$/.exec(a);if(b){a=new RegExp(b[1],b[2])}else{a=new RegExp(a)}if(!a.test(d)){return this.geterror(c,"form.is.not.match")}return true},"[maxlength],[data-maxlength]":function(c,b){var a=b.attr("maxlength")||b.attr("data-maxlength");if(a<c.length){return this.geterror(b,"form.gt.maxlength",[a])}return true},"[minlength],[data-minlength]":function(c,b){var a=b.attr("minlength")||b.attr("data-minlength");if(a>c.length){return this.geterror(b,"form.lt.minlength",[a])}return true},"[maxrepeat],[data-maxrepeat]":function(c,b){var a=b.attr("maxrepeat")||b.attr("data-maxrepeat");if(a<b.find("[type=hidden],:checked,:selected,:file,:text").size()){return this.geterror(b,"form.gt.maxrepeat",[a])}return true},"[minrepeat],[data-minrepeat]":function(c,b){var a=b.attr("minrepeat")||b.attr("data-minrepeat");if(a>b.find("[type=hidden],:checked,:selected,:file,:text").size()){return this.geterror(b,"form.lt.minrepeat",[a])}return true},"[max],[data-max]":function(d,c){var b=this.rules["[type=number],.input-number"].call(this,d,c);if(b!==true){return b}var a=c.attr("max")||c.attr("data-max");if(parseFloat(d)>parseFloat(a)){return this.geterror(c,"form.gt.max",[a])}return true},"[min],[data-min]":function(d,c){var b=this.rules["[type=number],.input-number"].call(this,d,c);if(b!==true){return b}var a=c.attr("min")||c.attr("data-min");if(parseFloat(d)<parseFloat(a)){return this.geterror(c,"form.lt.min",[a])}return true},"[type=number],.input-number":function(b,a){if(!b&&a[0]&&a[0].validity&&a[0].validity.badInput){return this.geterror(a,"form.is.not.number")}if(!/^-?[0-9]*(\.[0-9]+)?$/.test(b)){return this.geterror(a,"form.is.not.number")}return true},"[type=color],.input-color":function(b,a){if(!b){return true}if(!/^#[0-9A-Fa-f]{6}$/.test(b)){return this.geterror(a,"form.is.not.color")}return true},"[type=email],.input-email":function(b,a){if(!b){return true}if(!/^\w+([-.]\w+)*@\w+([-.]\w+)*$/.test(b)){return this.geterror(a,"form.is.not.email")}return true},"[type=url],.input-url":function(b,a){if(!b){return true}if(!/^([a-z]+:)?\/\/[^\s]+$/.test(b)){return this.geterror(a,"form.is.not.url")}return true},"[type=tel],.input-tel":function(b,a){if(!b){return true}if(!/^\+?[0-9][\d\-]+[0-9]$/.test(b)){return this.geterror(a,"form.is.not.tel")}return true},"[data-validate]":function(d,c){var b=c.attr("data-validate");try{if(c.data(b)){return c.data(b).call(this,d,c)}else{if(window[b]){return window[b].call(this,d,c)}else{if(window.console){if(window.console.error){window.console.error(b+" not found!")}else{window.console.log(b+" not found!")}}}}return false}catch(a){if(window.console){if(window.console.error){window.console.error(b+" run error: "+a,d,c)}else{window.console.log(b+" run error: "+a,d,c)}}return false}},"[data-verify]":function(f,d,b){if(!f){return true}var a=true;var e=this.formBox;var c=d.attr("name")||d.attr("data-fn");c=c.replace("..",".").replace("[]","").replace(/\.$/,"");if(!b){b=d.attr("data-verify")}b=b.replace(/\$\{(.*?)\}/g,function(g,h){return encodeURIComponent(e.find("[name='"+h+"']").not(".form-ignored").val()||"")});this.ajax({url:b,data:{n:c,v:f},type:"POST",dataType:"json",funcName:"veri",async:false,cache:false,global:false,context:this,complete:function(g){g=hsResponse(g);if(g.list!==undefined){a=d.attr("data-unique")?g.list.length==0:g.list.length!=0}else{if(g.page!==undefined){a=d.attr("data-unique")?g.page.count==0:g.page.count!=0}else{if(g.cnt!==undefined){a=parseInt(g.cnt)?true:(g.msg?g.msg:false)}else{a=g.ok?true:(g.msg?g.msg:false)}}}},error:function(){a=false}});return a},"[data-unique]":function(c,b){var a=this.rules["[data-verify]"].call(this,c,b,b.attr("data-unique"));if(typeof a==="string"){return a}else{if(!a){return this.geterror(b,"form.is.not.unique")}}return true},"[data-exists]":function(c,b){var a=this.rules["[data-verify]"].call(this,c,b,b.attr("data-exists"));if(typeof a==="string"){return a}else{if(!a){return this.geterror(b,"form.is.not.exists")}}return true},"[data-repeat]":function(c,b){var a=b.attr("data-repeat");if(c!=this.getvalue(this.getinput(a))){return this.geterror(b,"form.is.not.repeat")}return true},"[data-relate]":function(c,b){var a=b.attr("data-relate");if(this.getvalue(this.getinput(a))){this.validate(a)}return true}}};jQuery.fn.hsForm=function(a){return this.hsBind(HsForm,a)};(function(a){a(document).on("change","fieldset .checkall",function(b){this.indeterminate=false;var d=a(this).closest("fieldset");var c=a(this).prop("checked");d.find(":checkbox").not(".checkall").prop("checked",c).trigger("change")}).on("change","fieldset :checkbox:not(.checkall)",function(d){var f=a(this).closest("fieldset");var c=f.find(":checkbox:not(.checkall)").length;var b=f.find(":checkbox:not(.checkall):checked").length;var e=c&&c===b?true:(b&&c!==b?null:false);f.find(".checkall").prop("choosed",e)}).on("click","[data-toggle=hsEdit]",function(b){var f=a(this).closest(".HsForm").data("HsForm");var e=function(){a(this).on("saveBack",function(h,j,g){var i=jQuery.Event("saveBack");i.relatedTarget=h.target;i.relatedHsInst=g;f.formBox.trigger(i,[j,f]);if(i.isDefaultPrevented()){return}f.load()})};var d=a(this).attr("data-target");var c=a(this).attr("data-href");c=hsFixPms(c,this);if(d){d=a(this).hsFind(d);d.hsOpen(c,e)}else{a.hsOpen(c,e)}b.stopPropagation()})})(jQuery);