H$.uid=function(){if(window.HsCUID===undefined){if(hsGetAuth("centra",false)||hsGetAuth("centre",false)||hsGetAuth("public",false)){window.HsCUID=H$("%HsCUID")}else{window.HsCUID=null;H$("%HsCUID",null)}}return window.HsCUID};H$.mod=function(){var a=$(".HsList,.HsForm").filter(":visible:first");return a.data("HsList")||a.data("HsForm")};H$.src=function(){return(H$.mod()._url||location.pathname).replace(/\?.*/,"").replace(/\/[^\/]+$/,"")};H$.load=function(b){var a=H$.mod();a.load(undefined,hsSerialMix(a._data,b))};H$.send=function(b,c){var a;$.hsAjax({url:b,data:c,type:"post",dataType:"json",async:false,cache:false,global:false,complete:function(d){a=hsResponse(d,3)}});return a};H$.search=function(b){var a=H$.src()+"/search.act";return H$.send(a,b)};H$.create=function(b){var a=H$.src()+"/create.act";return H$.send(a,b)};H$.update=function(b){var a=H$.src()+"/update.act";return H$.send(a,b)};H$["delete"]=function(b){var a=H$.src()+"/delete.act";return H$.send(a,b)};function HsStat(b,d){b=$(b);var f=b.find(".statbox");var e=b.find(".findbox");var a=b.find(".toolbox");this.context=b;this.statBox=f;this.findBox=e;this.murl=d.murl;this.curl=d.curl;this.eurl=d.eurl;var c=this;f.data("changed",f.is(".invisible"));a.on("saveBack",function(){if(f.is(".invisible")){f.data("changed",true)}else{f.data("changed",false);setTimeout(function(){c.load()},1000)}});e.on("submit",function(){if(f.is(".invisible")){f.data("changed",true)}else{f.data("changed",false);setTimeout(function(){c.load()},1000)}});f.on("change","input,select",function(){if($(this).is(".checkall2")){$(this).closest(".checkbox").find(".checkone2").prop("checked",false)}else{if($(this).is(".checkone2")){$(this).closest(".checkbox").find(".checkall2").prop("checked",false)}}e.find(":submit").first().click()})}HsStat.prototype={load:function(){var a=this;var b=this.statBox;hsRequires("static/addons/echarts/echarts.min.js",function(){b.find(".stat-group").each(function(){var c=$(this);if(!c.data("echart")){var d=c.find(".chartbox");var e=echarts.init(d[0]);c.data("echart",e)}});a.fill(b.find("[data-type=ecount]"));a.fill(b.find("[data-type=acount]"));a.fill(b.find("[data-type=amount]"))})},fill:function(i){if(0===i.size()){return}var f=this;var c=this.context;var j=this.statBox;var d=this.findBox;var b=[];var g=[];var e=i.attr("data-type");var a=e==="amount"?this.murl:(e==="acount"?this.curl:this.eurl);i.each(function(){if($(this).data("name")){b.push($(this).data("name"))}if($(this).data("prms")){g.push($(this).data("prms"))}$(this).find(".checkbox").hide();$(this).find(".chartbox").hide();$(this).find(".alertbox").show().children().text($(this).data("text")+" 统计中...")});a=hsSetParam(a,"rb.",b)+g.join("&");var k;var h;do{h=c.data("HsList");if(h){k=h._data;break}h=c.data("HsTree");if(h){k=h._data;break}k=d}while(false);k=hsSerialMix({},k);delete k.rb;delete k["rb."];delete k.ob;delete k["ob."];$.hsAjax({url:a,data:k,dataType:"json",cache:true,success:function(o){o=o.enfo||{};for(var l in o){var m=o[l];var p=j.find("[data-name='"+l+"']");if(p.size()===0){continue}if(m.length===0){continue}p.find(".alertbox").hide();p.find(".checkbox").show();p.find(".chartbox").show();if(e==="amount"){f.setAmountCheck(p,m);f.setAmountChart(p,m)}else{f.setAcountCheck(p,m);f.setAcountChart(p,m)}l=p.find(".checkone2").attr("name");if(k&&k[l]){p.find(".checkone2").val(k[l])}else{p.find(".checkall2").prop("checked",true)}}i.each(function(){$(this).find(".alertbox:visible").children().text($(this).data("text")+" 无统计值!")})}})},copy:function(i){var d=i.find(".checkbox");if(!$.hsCanCopy()){$.hsWarn("浏览器无法拷贝\r\n请使用较新版的 Chrome/Firefox/Safari/Edge, 或某些双核/多核浏览器的极速模式.","warning");return}var j=[{mode:"warn",glass:"alert-default",text:"为了降低网络延迟, 图表按从多到少排, 仅取前 20 条; 而此功能将调取完整统计数据, 以便导入 Office/WPS 等应用中.",title:"正在获取完整统计数据, 请稍等...",topic:"已经取得完整统计数据, 请拷贝吧!",note:"拷贝成功, 去粘贴吧!"},{glass:"btn-primary copies",label:"拷贝"},{glass:"btn-default",label:"取消"}];var a=$.hsMask.apply($,j);var f=function(){a.removeClass("alert-info").addClass("alert-success");a.find(".alert-footer .btn").prop("disabled",false);a.find(".alert-title").text(j[0].topic);return a};a.find(".alert-footer button").prop("disabled",true);a.find(".alert-footer button.copies").click(function(){var m=d.children("div");var l=m.children("table");m.show();l.hsCopy();m.hide();$.hsNote(j[1].note,"success")});var c=d.children("div");if(c.size()){f();return}var e=i.attr("data-text");var h=i.attr("data-name");var g=i.attr("data-type");var b=g==="amount"?this.murl:(g==="acount"?this.curl:this.eurl);var k=this.findBox.serialize();b=hsSetParam(b,"rb",h);b=hsSetParam(b,"rn","0");$.hsAjax({url:b,data:k,dataType:"json",cache:true,success:function(w){var l=$("<div></div>").appendTo(d);var n=$("<table></table>").appendTo(l);var u=$("<thead></thead>").appendTo(n);var y=$("<tbody></tbody>").appendTo(n);var t=$("<tr></tr>");var m=$("<td></th>");var o=$("<td></td>");l.attr("style","height:1px; display:none; overflow:auto;");n.attr("style","margin:1px;").attr("class","table table-bordered");var q=t.clone().appendTo(u);m.clone().appendTo(q).text(e);m.clone().appendTo(q).text("数量");if(g==="amount"){m.clone().appendTo(q).text("求和");m.clone().appendTo(q).text("最小");m.clone().appendTo(q).text("最大")}if(w.enfo&&w.enfo[h]){var x=w.enfo[h];for(var r=0;r<x.length;r++){var v=x[r];if(v[1]===null){v[1]="#"+v[0]}q=t.clone().appendTo(y);for(var p=1;p<v.length;p++){var s=v[p];o.clone().appendTo(q).text(s)}}}f()}})},setAmountCheck:function(e,d){var a=e.data("name");var k=e.data("text");var f=e.find(".checkbox").empty();var h=$("<label></label>");var b=$('<input type="checkbox" class="checkall2"/>');var g=$("<span></span>").text("全部"+k);h.append(b).append(g).appendTo(f);for(var c=0;c<d.length;c++){var j=d[c];if(j[0]==""){continue}if(j[1]==null){j[1]="#"+j[0]}h=$("<label></label>").attr("title",j[1]+" ("+j[2]+", "+j[3]+")");b=$('<input type="checkbox" class="checkone2"/>').attr("name",a+".rg.").attr("value",j[0]);g=$("<span></span>").text(j[1]);h.append(b).append(g).appendTo(f)}},setAcountCheck:function(e,d){var a=e.data("name");var k=e.data("text");var f=e.find(".checkbox").empty();var h=$("<label></label>");var b=$('<input type="checkbox" class="checkall2"/>');var g=$("<span></span>").text("全部"+k);h.append(b).append(g).appendTo(f);for(var c=0;c<d.length;c++){var j=d[c];if(j[0]==""){continue}if(j[1]==null){j[1]="#"+j[0]}h=$("<label></label>").attr("title",j[1]+" ("+j[2]+")");b=$('<input type="checkbox" class="checkone2"/>').attr("name",a+".in.").attr("value",j[0]);g=$("<span></span>").text(j[1]);h.append(b).append(g).appendTo(f)}},setAcountChart:function(h,f){var k=this;var l=h.data("echart");var e=[];var c=[];var b=[];for(var g=0;g<f.length;g++){var m=f[g];if(m[0]==""||m[2]==0){continue}e.push(m[1]);c.push(m[2]);b.push({value:m[2],name:m[1]})}var j={series:[{data:b,type:"pie"}],xAxis:[{show:false}],yAxis:[{show:false}]};var d={series:[{data:c,type:"bar",barMaxWidth:13,itemStyle:{normal:{barBorderRadius:[4,4,0,0]}}}],xAxis:[{data:e,show:true,type:"category"}],yAxis:[{show:true,type:"value"}]};var a={grid:{top:30,left:15,right:15,bottom:0,containLabel:true},tooltip:{},toolbox:{show:true,feature:{show:true,myBar:{show:true,icon:"M85.312 938.688H1024V1024H0V0h85.312v938.688zM256 341.312h85.312V768H256V341.312zM512 128h85.312v640H512V128z m256 213.312h85.312V768H768V341.312z",iconStyle:{borderWidth:0,color:"#666"},title:"柱状图",onclick:function(){h.data("plot","bar");l.setOption(l._barOpts)}},myPie:{show:true,icon:"M85.312 512a426.688 426.688 0 0 0 844.8 85.312H426.688V93.888A426.816 426.816 0 0 0 85.312 512zM512 0v512h512a512 512 0 1 1-512-512z m506.816 438.848H585.152V5.184a512.32 512.32 0 0 1 433.664 433.664z",iconStyle:{borderWidth:0,color:"#666"},title:"饼视图",onclick:function(){h.data("plot","pie");l.setOption(l._pieOpts)}},myTab:{show:true,icon:"M512 1024A512 512 0 1 1 512 0a512 512 0 0 1 0 1024z m0-85.312A426.688 426.688 0 1 0 512 85.312a426.688 426.688 0 0 0 0 853.376zM320 576a64 64 0 1 1 0-128 64 64 0 0 1 0 128z m192 0a64 64 0 1 1 0-128 64 64 0 0 1 0 128z m192 0a64 64 0 1 1 0-128 64 64 0 0 1 0 128z",iconStyle:{borderWidth:0,color:"#666"},title:"导出",onclick:function(){k.copy(h)}}}}};l._pieOpts=j;l._barOpts=d;if(h.data("plot")=="pie"){$.extend(a,j)}else{$.extend(a,d)}l.resize();l.setOption(a)},setAmountChart:function(j,h){var m=this;var n=j.data("echart");var e=[];var c=[];var b=[];var k=[];var g=[];for(var f=0;f<h.length;f++){var o=h[f];if(o[0]==""||o[2]==0){continue}e.push(o[1]);c.push(o[2]);b.push(o[3]);k.push({value:o[2],name:o[1]});g.push({value:o[3],name:o[1]})}var l={series:[{radius:[0,50],data:k,type:"pie"},{radius:[60,80],data:g,type:"pie"}],xAxis:[{show:false}],yAxis:[{show:false},{show:false}]};var d={series:[{data:c,type:"bar",barMaxWidth:13,itemStyle:{normal:{barBorderRadius:[4,4,0,0]}}},{data:b,type:"bar",barMaxWidth:13,itemStyle:{normal:{barBorderRadius:[4,4,0,0]}}}],xAxis:[{data:e,show:true,type:"category"}],yAxis:[{show:true,type:"value"},{show:true,type:"value",position:"right"}]};var a={grid:{top:30,left:15,right:15,bottom:0,containLabel:true},tooltip:{},toolbox:{show:true,feature:{show:true,myBar:{show:true,icon:"M85.312 938.688H1024V1024H0V0h85.312v938.688zM256 341.312h85.312V768H256V341.312zM512 128h85.312v640H512V128z m256 213.312h85.312V768H768V341.312z",iconStyle:{borderWidth:0,color:"#666"},title:"柱状图",onclick:function(){j.data("plot","bar");n.setOption(n._barOpts)}},myPie:{show:true,icon:"M85.312 512a426.688 426.688 0 0 0 844.8 85.312H426.688V93.888A426.816 426.816 0 0 0 85.312 512zM512 0v512h512a512 512 0 1 1-512-512z m506.816 438.848H585.152V5.184a512.32 512.32 0 0 1 433.664 433.664z",iconStyle:{borderWidth:0,color:"#666"},title:"饼视图",onclick:function(){j.data("plot","pie");n.setOption(n._pieOpts)}},myTab:{show:true,icon:"M512 1024A512 512 0 1 1 512 0a512 512 0 0 1 0 1024z m0-85.312A426.688 426.688 0 1 0 512 85.312a426.688 426.688 0 0 0 0 853.376zM320 576a64 64 0 1 1 0-128 64 64 0 0 1 0 128z m192 0a64 64 0 1 1 0-128 64 64 0 0 1 0 128z m192 0a64 64 0 1 1 0-128 64 64 0 0 1 0 128z",iconStyle:{borderWidth:0,color:"#666"},title:"导出",onclick:function(){m.copy(j)}}}}};n._pieOpts=l;n._barOpts=d;if(j.data("plot")=="pie"){$.extend(a,l)}else{$.extend(a,d)}n.resize();n.setOption(a)}};jQuery.fn.hsStat=function(a){return this.hsBind(HsStat,a)};function HsCate(b,d){b=$(b);var f=b.find(".statbox");var e=b.find(".findbox");var a=b.find(".toolbox");this.context=b;this.statBox=f;this.findBox=e;this.murl=d.murl;this.curl=d.curl;this.eurl=d.eurl;var c=this;f.data("changed",f.is(".invisible"));a.on("saveBack",function(){if(f.is(".invisible")){f.data("changed",true)}else{f.data("changed",false);setTimeout(function(){c.load()},1000)}});e.on("submit",function(){if(f.is(".invisible")){f.data("changed",true)}else{f.data("changed",false);setTimeout(function(){c.load()},1000)}});f.on("change","input,select",function(){if($(this).is(".checkall2")){$(this).closest(".checkbox").find(".checkone2").prop("checked",false)}else{if($(this).is(".checkone2")){$(this).closest(".checkbox").find(".checkall2").prop("checked",false)}}e.find(":submit").first().click()})}HsCate.prototype={load:function(){var a=this;var b=this.statBox;a.fill(b.find("[data-type=ecount]"));a.fill(b.find("[data-type=acount]"));a.fill(b.find("[data-type=amount]"))},fill:function(i){if(0===i.size()){return}var f=this;var c=this.context;var j=this.statBox;var d=this.findBox;var b=[];var g=[];var e=i.attr("data-type");var a=e==="amount"?this.murl:(e==="acount"?this.curl:this.eurl);i.each(function(){if($(this).data("name")){b.push($(this).data("name"))}if($(this).data("prms")){g.push($(this).data("prms"))}$(this).empty()});a=hsSetParam(a,"rb.",b)+g.join("&");var k;var h;do{h=c.data("HsList");if(h){k=h._data;break}h=c.data("HsTree");if(h){k=h._data;break}k=d}while(false);k=hsSerialMix({},k);delete k.rb;delete k["rb."];delete k.ob;delete k["ob."];$.hsAjax({url:a,data:k,dataType:"json",cache:true,success:function(o){o=o.enfo||{};for(var l in o){var m=o[l];var p=j.find("[data-name='"+l+"']");if(p.size()===0){continue}if(m.length===0){continue}if(e==="amount"){f.setAmountCheck(p,m)}else{f.setAcountCheck(p,m)}l=p.find(".checkone2").attr("name");if(k&&k[l]){p.find(".checkone2").val(k[l])}else{p.find(".checkall2").prop("checked",true)}}i.filter(":empty").closest(".stat-group").hide()}})},setAmountCheck:function(e,d){var a=e.data("name");var k=e.data("text");var f=e.find(".checkbox").empty();if(d.length==0){e.closest(".form-group").hide();return}else{e.closest(".form-group").show()}var h=$("<label></label>");var b=$('<input type="checkbox" class="checkall2"/>');var g=$("<span></span>").text("全部");h.append(b).append(g).appendTo(f);for(var c=0;c<d.length;c++){var j=d[c];if(j[0]==""||j[2]==0){continue}h=$("<label></label>").attr("title",j[1]+" ("+j[2]+")");b=$('<input type="checkbox" class="checkone2"/>').attr("name",a+".rg.").attr("value",j[0]);g=$("<span></span>").text(j[1]);h.append(b).append(g).appendTo(f)}},setAcountCheck:function(e,d){var a=e.data("name");var k=e.data("text");var f=e.find(".checkbox").empty();if(d.length==0){e.closest(".form-group").hide();return}else{e.closest(".form-group").show()}var h=$("<label></label>");var b=$('<input type="checkbox" class="checkall2"/>');var g=$("<span></span>").text("全部");h.append(b).append(g).appendTo(f);for(var c=0;c<d.length;c++){var j=d[c];if(j[0]==""||j[2]==0){continue}h=$("<label></label>").attr("title",j[1]+" ("+j[2]+")");b=$('<input type="checkbox" class="checkone2"/>').attr("name",a+".in.").attr("value",j[0]);g=$("<span></span>").text(j[1]);h.append(b).append(g).appendTo(f)}}};jQuery.fn.hsCate=function(a){return this.hsBind(HsCate,a)};function HsPops(d,g){var e,c,a;d=jQuery(d);e=d.children(".tabs");c=d.children(".labs");a={};jQuery.each(g,function(i,h){a[h]=i});c.on("hsReady",".loadbox",function(){if(!$(this).parent().parent().is(c)){return}var i,h,k;i=hsFixUri("");b=hsFixUri($(this).data("href"));if(b.length<=i.length||b.substr(0,i.length)!==i){return}b=b.substr(i.length);var j=b.indexOf("?");if(j>=0){h=b.substring(1+j);b=b.substring(0,j)}k=a[b]||"";if(k){k="#"+k;if(h){k+="&"+h}}else{return}history.replaceState({},"",location.pathname+location.search+k)});c.on("hsClose",".loadbox",function(){if(!$(this).parent().parent().is(c)){return}history.replaceState({},"",location.pathname+location.search)});var f=/^#(\w+)(&.+)?/.exec(location.hash);if(f){var b=g[f[1]];if(b){b=b+(f[2]||"");b=b.replace("&","?");e.hsTabs();e.hsOpen(b)}}}jQuery.fn.hsPops=function(a){return this.hsBind(HsPops,a)};function HsVeil(a,b){this.sup=jQuery(a);this.sub=jQuery(b);this.sup.data("sub",b);this.sub.data("sup",a)}HsVeil.prototype={show:function(){if(this.sup.parent().size()===0){this.sup.insertBefore(this.sub);this.sub.detach()}},hide:function(){if(this.sub.parent().size()===0){this.sub.insertBefore(this.sup);this.sup.detach()}},toggle:function(){if(this.sup.parent().size()===0){this.show()}else{this.hide()}}};jQuery.fn.hsVeil=function(a){$(this).each(function(){var b=$(this).hsBind(HsVeil,function(){var c=$(this);var d=$(this).data("hsVeilNode");if(d===undefined){var e=$(this).data("hsVeilName");d=$('<input class="form-ignored" type="hidden"/>');d.attr("name",e||c.attr("data-fn")||c.attr("name")||c.find("[data-fn]").attr("data-fn")||c.find("[name]").attr("name"))}return d});if(a===undefined){b.toggle()}else{if(a){b.hide()}else{b.show()}}});return this};function hsListFillSele(a,b,c){hsListFillFork.call(this,a,b,c);a.find("input").attr("title",this._info.name).data(this._info)}function hsListFillFilt(a,b,c){c=c.replace(/^ar\.\d\./,"");c=c.replace(/\.(\w\w)$/,"");b=this._info[c];return b}function hsListDollFilt(h,j,b){b=b.replace(/^ar\.\d\./,"");b=b.replace(/\.(\w\w)$/,"");j=this._enfo[b];var d=h.attr("data-vk")||0;var l=h.attr("data-tk")||1;var c=h.find("[value='']").size()==0;if(c){for(var f=0;f<j.length;f++){var e=hsGetValue(j[f],d);if(e==""){c=false;break}}}if(c){var g=$.isArray(j)?[]:{};g[d]="";g[l]="";j.unshift(g)}return HsForm.prototype._doll__select.call(this,h,j,b)}function hsFillOpenLink(k,m,p){if(!m||!m.length){return}if(!$.isArray(m)){m=[m]}var c;switch(p){case"email":c="bi-hi-email";break;case"image":c="bi-hi-image";break;case"video":c="bi-hi-video";break;case"audio":c="bi-hi-audio";break;case"file":c="bi-hi-file";break;default:c="bi-hi-link";break}var j=$('<a><span class="'+c+'"></span></a>');var h=$('<a target="_blank"></a>');var d=$("<li></li>");var o=$("<ul></ul>");for(var g=0;g<m.length;g++){var f,b;if(p==="email"){b="mailto:"+m[g];f=m[g]}else{b=hsFixUri(m[g]);f=m[g].replace(/[?#].*/,"").replace(/.*\//,"");f=decodeURIComponent(f)}o.append(d.clone().append(h.clone().attr("href",b).text(f)))}k.addClass("dont-check");k.data("node",o);if(m.length>1){j.appendTo(k);j.attr("href","javascript:;");j.click(function(){var a=$.hsMask({title:"点击可打开..."});a.find(".modal-body").append(o);a.find(".modal-footer").remove()})}else{j.appendTo(k);j.attr("target","_blank");if(p==="email"){j.attr("href","mailto:"+m[0])}else{j.attr("href",hsFixUri(m[0]))}}}function hsListWrapOpen(a){return function(b,c){hsFillOpenLink(b,c,a)}}function hsFormWrapOpen(a){return function(b,c){hsFillOpenLink(b,c,a)}}function hsFillListMore(b,e){if(!e){return}var g=e;var i=b.data("title");var f=b.data("type");var h=$("<div></div>");var c=$('<a href="javascript:;"></ a>');if(!i){i=b.closest("td").index();i=b.closest("table").find("thead th,thead td").eq(i).text()}if(f==="html"){g=$("<div></div>").html(g).text();b.data("html",e)}else{b.data("text",e)}g=g.replace(/\s{2,}/g," ");g=$.trim(g);if(g.length>100){g=g.substr(0,100)+"..."}c.appendTo(h).text(g);h.appendTo(b).attr("title",g);h.css({overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap",width:"100%"});c.click(function(){if(f==="html"){$.hsMask({html:e,title:i,space:"pre-wrap"})}else{$.hsMask({text:e,title:i,space:"pre-wrap"})}})}function hsSaveListCols(d,h){var g=d.is("table")?d:d.find("table:first");var b=g.children("thead").children().children();var a=H$("%list-cols-"+h);if(a){a=a.split(",");for(var c=0;c<a.length;c++){var e=a[c];if(e){b.filter("[data-fn='"+e+"']").not(".dont-hide").addClass("hidden")}}}d.on("hideCols",function(){a=[];b.filter(".hidden").not(".dont-hide").each(function(){a.push($(this).data("fn"))});a=a.join(",");if(!a){a=null}H$("%list-cols-"+h,a)})}function hsHideListCols(c){var e=c.is("table")?c:c.find("table:first");var a=e.children("thead").children().children();var b=$('<form class="checkbox" onsubmit="return false"></form>');var d=$('<label><input type="checkbox" name="rb."><span></span></label>');a.each(function(){if($(this).is(".dont-hide,._admin,._check,._radio,._rowid")){return}var f=d.clone().appendTo(b);f.find("span").text($(this).text());f.find("input").val($(this).data("fn"));f.find("input").prop("checked",!$(this).is(".hidden"))});$.hsMask({title:"请选择要显示的列"},{label:"确定",glass:"btn-primary",click:function(){var f=e.children("thead,tbody,tfoot").children();b.find("input").each(function(){var g=$(this).prop("checked");var h=$(this).val();var i=a.filter('[data-fn="'+h+'"]').index();f.each(function(){$(this).children().eq(i).toggleClass("hidden",!g)})});c.trigger("hideCols")}},{label:"关闭",glass:"btn-default"},{label:"全选",glass:"btn-link pull-left",click:function(f){b.find(":checkbox").prop("checked",true);f.preventDefault();return false}},{label:"全否",glass:"btn-link pull-left",click:function(f){b.find(":checkbox").prop("checked",false);f.preventDefault();return false}}).find(".modal-body").append(b)}function hsCopyListData(j){if(!$.hsCanCopy()){$.hsWarn("浏览器无法拷贝\r\n请使用较新版的 Chrome/Firefox/Safari/Edge, 或某些双核/多核浏览器的极速模式.","warning");return}var m;var n=[{mode:"warn",glass:"alert-default",text:"这将整理原始数据, 清理表格中的内容, 提取完整的日期/时间, 补全图片/链接等网址, 以便导入 Office/WPS 等应用中.",title:"正在组织列表原始数据, 请稍等...",topic:"已经备好列表原始数据, 请拷贝吧!",note:"拷贝成功, 去粘贴吧!"},{glass:"btn-primary copies",label:"拷贝"},{glass:"btn-default",label:"取消"}];if(arguments.length>1){m=[].slice.call(arguments,1);m[0]=$.extend(n[0],m[0])}else{m=n}var c=$.hsMask.apply($,m);var q=function(){c.removeClass("alert-info").addClass("alert-success");c.find(".alert-footer .btn").prop("disabled",false);c.find(".alert-title").text(m[0].topic);return c};c.find(".alert-footer button").prop("disabled",true);c.find(".alert-footer button.copies").click(function(){c.prev().show().children().hsCopy();$.hsNote(m[0].note,"success")});var o=$("<div></div>").insertBefore(c);var b=$("<table></table>").appendTo(o);var h=$("<thead></thead>").appendTo(b);var g=$("<tbody></tbody>").appendTo(b);var a=$("<tr></tr>");var e=$("<th></th>");var f=$("<td></td>");o.attr("style","height: 1px; display: none; overflow: auto;");b.attr("style","margin: 1px; white-space: pre-line;");b.attr("class","table table-bordered table-copylist");if(j instanceof jQuery||j instanceof Element){j=$(j);j.find("thead:first tr").each(function(){var i=a.clone().appendTo(h);$(this).find("th").each(function(){var v=$(this);if(v.is(".dont-copy,._check,._admin,:hidden")){return}var u=e.clone().appendTo(i);u.text(v.text())})});j.find("tbody:first tr").each(function(){if(!$(this).is(".active")){return}var i=a.clone().appendTo(g);$(this).find("td").each(function(){var v=$(this);if(v.is(".dont-copy,._check,._admin,:hidden")){return}var u=f.clone().appendTo(i);if(v.data("node")){u.html(hsTidyHtmlTags(v.data("node")))}else{if(v.data("html")){u.html(hsTidyHtmlTags(v.data("html")))}else{if(v.data("text")){u.text(v.data("text"))}else{if(v.attr("title")){u.text(v.attr("title"))}else{u.html(hsTidyHtmlTags(v.html()))}}}}})});g.find("td").not(".numerial").attr("style","mso-number-format:'\\@';vnd.ms-excel.numberformat:'@';")}else{var k=j.cols||[];var r=j.list||[];var t=new HsList({context:o});t.listBox=b;var s=a.clone().appendTo(h);for(var p=1;p<k.length;p++){var l=e.clone().appendTo(s);var d=k[p];if(typeof d==="string"||typeof d==="number"){d={fn:d}}l.attr("class",d.glass);l.attr("style",d.style);l.text(d.label||"");l.data(d)}t.fillList(r);g.find("td").not(".numerial").attr("style","mso-number-format:'\\@';vnd.ms-excel.numberformat:'@';")}return q()}function hsTidyHtmlTags(a){if(!a){return""}if(typeof a==="number"){return a+""}if(typeof a==="object"){a=$(a).html()}a=a.replace(/\s+/gm," ");a=a.replace(/<\/?(p|br|hr|ul|ol|li|div|pre)(\/|\s.*?)?>/igm,"\r\n");return $.trim(a)}function hsSaveWithMemo(a){return function(){var c=arguments;var g=c[1];var e=this;var b=jQuery('<input type="text" name="memo" class="form-control" placeholder="选填, 请输入操作备注, 如: 补充简介信息"/>');var f=function(){delete e._waiting};var d=function(){g.append("memo",b.val());HsForm.prototype.save.apply(e,c)};if(a){this.warn(a,"default",d,f).find(".alert-body").append(b).trigger("shown.bs.modal")}else{d()}}}function hsSendWithMemo(c,g,b,f){var e=this;var a=jQuery('<input type="text" name="memo" class="form-control" placeholder="选填, 请输入操作备注, 如: 清理重复数据"/>');var d=function(){var h=jQuery.extend({},hsSerialDat(f),{memo:a.val()});var i=jQuery.extend({},hsSerialDat(b),hsSerialDat(f));e.ajax({url:b,data:h,type:"POST",dataType:"json",funcName:"send",cache:false,context:e,trigger:c,success:function(j){this.sendBack(c,j,i)}})};if(g){this.warn(g,"warning",d,null).find(".alert-body").append(a).trigger("shown.bs.modal")}else{d()}}function hsLoadWithWord(a,b){var c=this.context.find(".findbox [name=wd]").val();if(b&&c&&/^\?.+=/.test(c)){c=hsSerialDic(c);b=hsSerialDic(b);delete b.wd;b=hsSerialMix(b,c)}HsList.prototype.load.call(this,a,b)}hsFindWithWord=hsLoadWithWord;function hsListFillLogo(b,a){if(!a){return}b.css({"background-size":"cover","background-repeat":"no-repeat","background-position":"center center","background-image":"url("+a+")"})}function hsListShowEdit(b,a){if(a){if(a.uid!==undefined){a=a.uid}else{if(a.id!==undefined){a=a.id}}}if(a&&a==H$.uid()){b.show()}}function hsListInitMine(a,b,d){var c=H$.uid();a.next().on("change",":radio",function(){switch($(this).val()){case"1":a.attr("name",d+".eq").val(c);break;case"2":a.attr("name",d+".ne").val(c);break;default:a.attr("name",d).val("");break}$(this).closest("label").siblings().find("input").prop("checked",false)})}function hsListInitSort(a,c,f){var d=a;var e=a.next().find("select").eq(0);var b=a.next().find("select").eq(1);b.addClass("invisible");a.next().change(function(){if(e.find("option").first().prop("selected")){b.find("option").first().prop("selected",true);b.toggleClass("invisible",true)}else{b.toggleClass("invisible",false)}if(b.val()==="-"){d.val(b.val()+e.val())}else{d.val(e.val()+b.val())}})}function hsDarkMode(h,g){var d=$(document.documentElement);if(window._HsDarkTime){clearInterval(window._HsDarkTime)}switch(h){case"2":if(!g||!/^\d{8}$/.test(g)){throw new Error("hsDarkMode: Wrong dark time format: "+g)}d.removeClass("dusk-mode");var a=g.substring(0,4);var f=g.substring(4,8);var j=a>f?function(b){return(b>=a||b<f)}:function(b){return(b>=a&&b<f)};function i(){var e=new Date();var c=e.getHours();var b=e.getMinutes();if(j((c*100)+(b<10?b*10:b))){d.addClass("dark-mode")}else{d.removeClass("dark-mode")}}i();window._HsDarkTime=setInterval(i,60000);break;case"1":d.removeClass("dusk-mode").addClass("dark-mode");break;case"0":d.removeClass("dark-mode").addClass("dusk-mode");break;default:d.removeClass("dark-mode").removeClass("dusk-mode");break}}(function(a){if(!a(document.documentElement).hasClass("deny-dark")){hsDarkMode(H$("%HsDarkMode")||"0",H$("%HsDarkTime")||"18000600")}a(window).on("popstate",function(b){b=b.originalEvent;if(!b||!b.state||!b.state.crumb){return}a("#main-context>.breadcrumb>.back-crumb:visible>a").click();history.pushState({crumb:true},null,null)});history.pushState({crumb:true},null,null);a(document).on("reset",".HsList .findbox",function(){var b=a(this);b.find("[data-ft=_fork]").each(function(){hsFormFillFork(a(this),{})});setTimeout(function(){b.find(":submit").first().click()},500)})})(jQuery);
function setFormItems(b,a){b.on("loadOver",function(c,e){var d;d=b.find("[data-toggle=dateinput],[data-toggle=datetimepicker]");if(d.size()){forDateInput()}d=b.find("[data-toggle=suggest]");if(d.size()){forSuggInput()}d=b.find("[data-toggle=fileinput]");if(d.size()){setFileInput(d)}d=b.find("[data-toggle=tagsinput]");if(d.size()){setTagsInput(d)}d=b.find("textarea[data-type=html]");if(d.size()){setEditor(d)}d=b.find("textarea[data-type=code]");if(d.size()){setMirror(d)}});b.on("willSave",function(c,d){synEditor(b.find("textarea[data-type]"));if(d){b.find("textarea[data-type]").each(function(){d.set($(this).attr("name"),$(this).val())})}});a.on("hsClose",function(c,d){desEditor(b.find("textarea[data-type]"))})}function setInfoItems(b,a){b.on("loadOver",function(c,e){var d;d=b.find("textarea[data-type=code]");if(d.size()){setMirror(d)}d=b.find("pre[data-type=code]");if(d.size()){setMirror(d)}});a.on("hsClose",function(c,d){desEditor(b.find("textarea[data-type]"))})}function forDateInput(a){hsRequires(["static/addons/bootstrap-datetimepicker/css/datetimepicker.min.css","static/addons/bootstrap-datetimepicker/datetimepicker.min.js"],a)}function forSuggInput(a){hsRequires(["static/addons/bootstrap-suggest/suggest.min.js"],a)}function forFileInput(a){hsRequires(["static/addons/bootstrap-fileinput/css/fileinput.min.css","static/addons/bootstrap-fileinput/fileinput.min.js"],a)}function setFileInput(b,a){forFileInput(function(){b.hsFileInput();a&&a.call(b)})}function forTagsInput(a){hsRequires(["static/addons/bootstrap-tagsinput/css/tagsinput.min.css","static/addons/bootstrap-tagsinput/tagsinput.min.js"],a)}function setTagsInput(b,a){forTagsInput(function(){b.hsTagsInput();a&&a.call(b)})}function synEditor(a){a.each(function(){if($(this).data("synchro")){$(this).data("synchro")()}})}function desEditor(a){a.each(function(){if($(this).data("destroy")){$(this).data("destroy")()}})}function forEditor(a){hsRequires(["static/addons/summernote/summernote.min.css","static/addons/summernote/summernote.min.js"],function(){var b=HsLANG.lang;if(b&&b!="en_US"){b=b.replace("_","-")}else{b=null}if(b){hsRequires(["static/addons/summernote/lang/summernote-"+b+".js"],a)}else{a()}})}function setEditor(b,a){forMirror(function(){forEditor(function(){b.each(function(){var d=this;var e=$(this).hsData()||{};var f=HsLANG.lang.replace("_","-");var c={toolbar:[["font",["color","bold","italic","underline"]],["inst",["table","picture","link","hr"]],["para",["style","paragraph","ul","ol"]],["misc",["clean","codeview"]]],buttons:{clean:function(){return $.summernote.ui.button({contents:'<i class="note-icon-eraser"></i>',tooltip:$.summernote.lang[f].font.clear,click:function(){$.hsMask({title:"富文本格式化工具",html:'<form class="form-horizontal" onsubmit="return false"><div class="form-group row"><label class="col-xs-4 text-right control-label form-control-static">字体</label><div class="col-xs-6"><input class="form-control" type="text"   name="font-family" value="" data-unit="" list="hs-font-list"><datalist id="hs-font-list"><option value="宋体,STSong"  style="font-family: 宋体,STSong" >宋体</option><option value="黑体,STHeiti" style="font-family: 黑体,STHeiti">黑体</option><option value="楷体,STKaiti" style="font-family: 楷体,STKaiti">楷体</option></datalist></div></div><div class="form-group row"><label class="col-xs-4 text-right control-label form-control-static">字号</label><div class="col-xs-4"><input class="form-control" type="number" name="font-size"   value="" data-unit="px" step="1"   min="0" max="36"></div><div class="col-xs-2 form-control-static">(px)</div></div><div class="form-group row"><label class="col-xs-4 text-right control-label form-control-static">行高</label><div class="col-xs-4"><input class="form-control" type="number" name="line-height" value="" data-unit="em" step="0.1" min="0" max="8" ></div><div class="col-xs-2 form-control-static">(em)</div></div><div class="form-group row"><label class="col-xs-4 text-right control-label form-control-static">缩进</label><div class="col-xs-4"><input class="form-control" type="number" name="text-indent" value="" data-unit="em" step="0.5" min="0" max="8" ></div><div class="col-xs-2 form-control-static">(em)</div></div><div class="form-group row"><label class="col-xs-4 text-right control-label form-control-static">段尾间距</label><div class="col-xs-4"><input class="form-control" type="number" name="margin-bottom" value="" data-unit="px" step="1" min="0" max="80"></div><div class="col-xs-2 form-control-static">(px)</div></div><div class="form-group row"><label class="col-xs-4 text-right control-label form-control-static">文本对齐</label><div class="col-xs-4"><select class="form-control" name="text-align" data-unit=""><option value=""></option><option value="center" > 居中对齐</option><option value="justify"> 两端对齐</option></select></div></div><div class="form-group row"><label class="col-xs-4 text-right control-label form-control-static">图片样式</label><div class="col-xs-8 radio checkbox"><label><input type="checkbox" name="pics" data-float="" data-margin="0 auto" data-display="block"> 居中</label><label><input type="checkbox" name="picw" data-width="100%"> 宽 100%</label></div></div><div class="form-group row"><label class="col-xs-4 text-right control-label form-control-static">应用范围</label><div class="col-xs-8 radio"><label><input type="radio" name="area" value="range" checked="checked"> 选段</label><label><input type="radio" name="area" value="whole"> 全部</label><label><input type="radio" name="area" value="clean"> 清理</label></div></div></form>'},{label:"应用",glass:"btn-primary",click:function(){var j=$(this).closest(".modal-content").find("form");var k=j.find("[name=area]:checked").val();var n={width:"",margin:"",display:""};var g={};var r;switch(k){case"range":r=$(d).summernote("getLastRange").nodes();break;case"whole":r=$(d).data("summernote").layoutInfo.editable;r=$(r).find("p,pre,div,ul,ol,h1,h2,h3,h4,h5,h6,table");break;case"clean":var l;l=$(d).summernote("code");if(!/<\w+[^>]+>/.test(l)){l=l.replace(/^/g,"<p>");l=l.replace(/$/g,"</p>")}else{l=l.replace(/<!--[\S\s]*?-->/mg,"");l=l.replace(/(<font(\s[^>]*)?>|<\/font>)/mg,"");l=l.replace(/(<span(\s[^>]*)?>|<\/span>)/mg,"");l=l.replace(/\s(style|class|align|color)=\"[\S\s]*?\"/mg,"");l=l.replace(/<o:p><\/o:p>/mg,"<br/>")}$(d).summernote("code",l);r=$(d).data("summernote").layoutInfo.editable;r=$(r).find("p,pre,div,ul,ol,h1,h2,h3,h4,h5,h6,table");break}j.find("[name^=pic]").each(function(){if($(this).prop("checked")){$.extend(n,$(this).data())}});j.find("[data-unit]").each(function(){var i=$(this).val();var m=$(this).data("unit");var p=$(this).attr("name");if(i===""||i==="0"){i=m=""}g[p]=i+m});for(var q=0;q<r.length;q++){var h=$(r[q]).closest("p,pre,div,h1,h2,h3,h4,h5,h6,ul,ol,table,blockquote,.note-editable");if(h.is(".note-editable")){continue}h.css(g);var o=h.find("img");if(o.size()===0){continue}o.css(n);if(g["text-indent"]&&h.is("h1,h2,h3,h4,h5,h6,ul,ol,table")){h.css("text-indent","")}}$(d).summernote("triggerEvent","change")}},{label:"取消",glass:"btn-default"})}}).render()}},callbacks:{onImageUpload:function(h){var j=new FormData();for(var g=0;g<h.length;g++){j.append("file.",h[g])}$.ajax({url:hsFixUri(ADD_IMG_HREF),data:j,type:"POST",dataType:"json",cache:false,contentType:false,processData:false,success:function(l){l=hsResponse(l);if(!l.ok){return}for(var k=0;k<l.file.length;k++){$(d).summernote("insertImage",l.file[k])}}})}},codemirror:{mode:"text/html",htmlMode:true,lineNumbers:true,lineWrapping:true},styleTags:["p","h6","h5","h4","h3","h2","h1","pre","blockquote"],colorButton:{foreColor:"inherit",backColor:"transparent"},placeholder:$(this).attr("placeholder")||"",minHeight:$(this).height()*1,maxHeight:$(this).height()*2,lang:f};$(this).summernote($.extend(c,e));$(this).siblings(".note-editor").find(".note-current-color-button").attr("data-backcolor","inherit").find("i").css("background-color","inherit");$(this).data("destroy",function(){$(d).summernote("destroy")});$(this).data("synchro",function(){$(d).summernote("triggerEvent","change")})});a&&a.call(b)})},"xml")}function forMirror(a,b){hsRequires(["static/addons/codemirror/codemirror.min.css","static/addons/codemirror/codemirror.min.js"],function(){if(!$.isArray(b)){b=[b]}var d=[];for(var c=0;c<b.length;c++){d.push("static/addons/codemirror/mode/"+b[c]+"/"+b[c]+".js")}if(d.length){hsRequires(d,a)}else{a()}})}function setMirror(c,b){var a=[];c.each(function(){var d=$(this).data("mode")||$(this).data("type");d=getModeByName(d);a.push(d[0])});forMirror(function(){c.each(function(){var f=$(this);var g=$(this).data("mode")||$(this).data("type");g=getModeByName(g);if(f.is("textarea")){var d=CodeMirror.fromTextArea(f[0],{mode:g[1],tabSize:4,indentUnit:4,smartIndent:true,lineNumbers:true,readOnly:f.prop("readonly"),value:f.val()});var e=$(d.getWrapperElement());e.addClass("form-control");e.height(f.height());f.addClass("invisible");f.data("CM",d);f.data("destroy",function(){d.toTextArea()});f.data("synchro",function(){d.save()})}else{var d=CodeMirror(f.parent()[0],{mode:g[1],tabSize:4,indentUnit:4,smartIndent:true,lineNumbers:true,readOnly:"nocursor",value:f.text()});var e=$(d.getWrapperElement());e.addClass("form-control-static");e.height("auto");f.data("CM",d);f.text("");f.hide()}});b&&b.call(c)},a)}function getModeByName(a){if(a){a=a.replace(/.*\./,"");return EXTN_TO_MODE[a]||[a,a]}else{return[a,a]}}var ADD_IMG_HREF=hsChkUri("centra")?"centra/data/upload/image/create.act":"centre/data/upload/image/create.act";var EXTN_TO_MODE={h:["clike","text/x-c"],c:["clike","text/x-c"],cpp:["clike","text/x-c++src"],cs:["clike","text/x-csharp"],mm:["clike","text/x-objectivec"],m:["clike","text/x-objectivec"],java:["clike","text/x-java"],scala:["clike","text/x-scala"],kotlin:["clike","text/x-kotlin"],groovy:["groovy","groovy"],gradle:["groovy","groovy"],json:["javascript","application/json"],js:["javascript","text/javascript"],ts:["javascript","text/typescrpit"],coffee:["coffee","text/coffeescript"],jsx:["jsx","jsx"],vue:["vue","vue"],xml:["xml","xml"],xsd:["xml","xml"],dtd:["dtd","dtd"],html:["htmlmixed","text/html"],htm:["htmlmixed","text/html"],asp:["htmlembedded","text/aspx"],jsp:["htmlembedded","text/jsp"],go:["go","go"],sql:["sql","sql"],lua:["lua","lua"],php:["php","php"],rb:["ruby","ruby"],py:["python","python"],pl:["perl","perl"],pm:["perl","perl"],sh:["shell","shell"],bat:["shell","shell"],cmd:["shell","shell"],ps1:["powershell","powershell"],css:["css","css"],scss:["css","text/x-scss"],less:["css","text/x-less"],sass:["sass","text/x-sass"],md:["markdown","markdown"],proto:["protobuf","protobuf"],ini:["properties","properties"],cnf:["properties","properties"],conf:["properties","properties"],properties:["properties","properties"]};
