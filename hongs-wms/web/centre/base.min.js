hsChkUri("public")?window.HsCUID=H$("%HsCUID"):(window.HsCUID=null,H$("%HsCUID",null));$(document).on("reset",".HsList .findbox",function(){var a=$(this);a.find("[data-ft=_fork]").each(function(){hsFormFillFork($(this),{})});setTimeout(function(){a.find(":submit").first().click()},500)});function S$(){var a=$(".HsList,.HsForm").filter(":visible:first");return a.data("HsList")||a.data("HsForm")}S$.src=function(){return(S$()._url||location.pathname).replace(/\?.*/,"").replace(/\/[^\/]+$/,"")};
S$.send=function(a,b){var d;$.hsAjax({url:hsFixUri(a),data:hsSerialArr(b),complete:function(a){d=hsResponse(a,3)},type:"post",dataType:"json",async:!1,cache:!1,global:!1});return d};S$.search=function(a){var b=S$.src()+"/search.act";return S$.send(b,a)};S$.create=function(a){var b=S$.src()+"/create.act";return S$.send(b,a)};S$.update=function(a){var b=S$.src()+"/update.act";return S$.send(b,a)};S$.remove=function(a){var b=S$.src()+"/delete.act";return S$.send(b,a)};
S$.browse=function(a){var b=S$();b.load(void 0,hsSerialMix(b._data,a))};function hsListShowEdit(a,b){b&&(void 0!==b.uid?b=b.uid:void 0!==b.id&&(b=b.id));b&&b==window.HsCUID&&a.show()}function hsListFillLogo(a,b){b&&a.css({"background-size":"cover","background-repeat":"no-repeat","background-position":"center center","background-image":"url("+b+")"})}function hsListFillFilt(a,b,d){d=d.replace(/^ar\.\d\./,"");return b=this._info[d]}
function hsListDollFilt(a,b,d){d=d.replace(/^ar\.\d\./,"");b=this._enum[d];for(var e=a.attr("data-vk")||0,f=a.attr("data-tk")||1,c=!0,g=0;g<b.length;g++)if(""==hsGetValue(b[g],e)){c=!1;break}c&&(c=$.isArray(b)?[]:{},c[e]="",c[f]="",b.unshift(c));return HsForm.prototype._doll__select.call(this,a,b,d)}var hsListPrepFilt=hsListDollFilt;
function hsListInitSort(a,b,d){var e=a.next().find("select").eq(0),f=a.next().find("select").eq(1);f.addClass("invisible");a.next().change(function(){e.find("option").first().prop("selected")?(f.find("option").first().prop("selected",!0),f.toggleClass("invisible",!0)):f.toggleClass("invisible",!1);a.val(f.val()+e.val())})}
function hsListInitMine(a,b,d){a.next().on("change",":radio",function(){switch($(this).val()){case "1":a.attr("name",d+".eq").val(HsCUID);break;case "2":a.attr("name",d+".ne").val(HsCUID);break;default:a.attr("name",d).val("")}$(this).closest("label").siblings().find("input").prop("checked",!1)})}
function HsPops(a,b){a=jQuery(a);var d=a.closest(".labs");var e=!1;a.hsLoad(b.listUrl+hsSetParam(location.search,"id",null));$(window).on("popstate",function(){e=!0;d.children().eq(2).children().hsClose();hsGetParam(location.search,"id")?hsGetParam(location.search,"if")?b.formUrl&&(e=!0,d.hsOpen(b.formUrl+location.search)):b.infoUrl&&(e=!0,d.hsOpen(b.infoUrl+location.search)):hsGetParam(location.search,"if")&&b.addsUrl&&(e=!0,d.hsOpen(b.addsUrl+location.search))});$(window).trigger("popstate");d.on("hsReady",
".loadbox",function(){if(e)e=!1;else{var a=location.search;var c=hsFixUri($(this).data("href"));b.infoUrl&&c.substr(0,b.infoUrl.length)==b.infoUrl?(c=hsGetParam(c,"id"),a=hsSetParam(a,"id",c),a=hsSetParam(a,"if",null),history.pushState({},"",location.pathname+a)):b.formUrl&&c.substr(0,b.formUrl.length)==b.formUrl?(c=hsGetParam(c,"id"),a=hsSetParam(a,"id",c),a=hsSetParam(a,"if","1"),history.pushState({},"",location.pathname+a)):b.addsUrl&&c.substr(0,b.addsUrl.length)==b.addsUrl&&(a=hsSetParam(a,"id",
null),a=hsSetParam(a,"if","1"),history.pushState({},"",location.pathname+a))}});d.on("hsClose",".loadbox",function(){if(e)e=!1;else{var a=location.search,c=hsFixUri($(this).data("href"));if(b.infoUrl&&c.substr(0,b.infoUrl.length)==b.infoUrl||b.formUrl&&c.substr(0,b.formUrl.length)==b.formUrl||b.addsUrl&&c.substr(0,b.addsUrl.length)==b.addsUrl)a=hsSetParam(a,"id",null),a=hsSetParam(a,"if",null),history.pushState({},"",location.pathname+a)}})}
function HsCate(a,b){a=$(a);var d=a.find(".statbox"),e=a.find(".findbox"),f=a.find(".toolbox");this.context=a;this.statBox=d;this.findBox=e;this.murl=b.murl;this.curl=b.curl;this.eurl=b.eurl;var c=this;d.data("changed",d.is(".invisible"));f.on("saveBack",function(){d.is(".invisible")?d.data("changed",!0):(d.data("changed",!1),setTimeout(function(){c.load()},1E3))});e.on("submit",function(){d.is(".invisible")?d.data("changed",!0):(d.data("changed",!1),setTimeout(function(){c.load()},1E3))});d.on("change",
"input,select",function(){$(this).is(".checkall2")?$(this).closest(".checkbox").find(".checkone2").prop("checked",!1):$(this).is(".checkone2")&&$(this).closest(".checkbox").find(".checkall2").prop("checked",!1);e.find(":submit").first().click()})}
HsCate.prototype={load:function(){var a=this.statBox;this.fill(a.find("[data-type=ecount]"));this.fill(a.find("[data-type=acount]"));this.fill(a.find("[data-type=amount]"))},fill:function(a){if(0!==a.size()){var b=this,d=this.context,e=this.statBox,f=this.findBox,c=[],g=[],l=a.attr("data-type"),m="amount"===l?this.murl:"acount"===l?this.curl:this.eurl;a.each(function(){$(this).data("name")&&c.push($(this).data("name"));$(this).data("extr")&&g.push($(this).data("extr"));$(this).empty()});m=hsSetParam(m,
"rb.",c)+g.join("&");var k;var h=(k=d.data("HsList"))?k._data:(k=d.data("HsTree"))?k._data:hsSerialDic(f);$.hsAjax({url:m,data:h,dataType:"json",cache:!0,success:function(c){c=c.info||{};for(var d in c){var f=c[d],g=e.find("[data-name='"+d+"']");0!==g.size()&&0!==f.length&&("amount"===l?b.setAmountCheck(g,f):b.setAcountCheck(g,f),d=g.find(".checkone2").attr("name"),h&&h[d]?g.find(".checkone2").val(h[d]):g.find(".checkall2").prop("checked",!0))}a.filter(":empty").closest(".stat-group").hide()}})}},
setAmountCheck:function(a,b){var d=a.data("name");a.data("text");var e=a.empty();if(0==b.length)a.closest(".form-group").hide();else{a.closest(".form-group").show();a=$("<label></label>");var f=$('<input type="checkbox" class="checkall2"/>'),c=$("<span></span>").text("\u5168\u90e8");a.append(f).append(c).appendTo(e);for(var g=0;g<b.length;g++)c=b[g],""!=c[0]&&0!=c[2]&&(a=$("<label></label>").attr("title",c[1]+" ("+c[2]+")"),f=$('<input type="checkbox" class="checkone2"/>').attr("name",d+".rg.").attr("value",
c[0]),c=$("<span></span>").text(c[1]),a.append(f).append(c).appendTo(e))}},setAcountCheck:function(a,b){var d=a.data("name");a.data("text");var e=a.empty();if(0==b.length)a.closest(".form-group").hide();else{a.closest(".form-group").show();a=$("<label></label>");var f=$('<input type="checkbox" class="checkall2"/>'),c=$("<span></span>").text("\u5168\u90e8");a.append(f).append(c).appendTo(e);for(var g=0;g<b.length;g++)c=b[g],""!=c[0]&&0!=c[2]&&(a=$("<label></label>").attr("title",c[1]+" ("+c[2]+")"),
f=$('<input type="checkbox" class="checkone2"/>').attr("name",d+".in.").attr("value",c[0]),c=$("<span></span>").text(c[1]),a.append(f).append(c).appendTo(e))}}};jQuery.fn.hsCate=function(a){return this._hsModule(HsCate,a)};