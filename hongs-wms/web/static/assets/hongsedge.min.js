H$.uid=function(){if(window.HsCUID===undefined){if(hsGetAuth("centra",false)||hsGetAuth("centre",false)||hsGetAuth("public",false)){window.HsCUID=H$("%HsCUID")}else{window.HsCUID=null}}return window.HsCUID};H$.mod=function(){var a=$(".HsList,.HsForm").filter(":visible:first");return a.data("HsList")||a.data("HsForm")};H$.src=function(){return(H$.mod()._url||location.pathname).replace(/\?.*/,"").replace(/\/[^\/]+$/,"")};H$.load=function(b){var a=H$.mod();a.load(undefined,hsSerialMix(a._data,b))};H$.send=function(b,c){var a;$.hsAjax({url:b,data:c,type:"post",dataType:"json",async:false,cache:false,global:false,complete:function(d){a=hsResponse(d,3)}});return a};H$.search=function(b){var a=H$.src()+"/search.act";return H$.send(a,b)};H$.create=function(b){var a=H$.src()+"/create.act";return H$.send(a,b)};H$.update=function(b){var a=H$.src()+"/update.act";return H$.send(a,b)};H$["delete"]=function(b){var a=H$.src()+"/delete.act";return H$.send(a,b)};function HsPops(c,e){c=jQuery(c);var a={};jQuery.each(e,function(h,g){a[g]=h});c.on("hsReady",".loadbox",function(){if(!$(this).parent().parent().is(c)){return}var h,g,j;h=hsFixUri("");b=hsFixUri($(this).data("href"));if(b.length<=h.length||b.substr(0,h.length)!==h){return}b=b.substr(h.length);var i=b.indexOf("?");if(i>=0){g=b.substring(1+i);b=b.substring(0,i)}j=a[b]||"";if(j){j="#"+j;if(g){j+="&"+g}}else{return}history.replaceState({},"",location.pathname+location.search+j)});c.on("hsClose",".loadbox",function(){if(!$(this).parent().parent().is(c)){return}history.replaceState({},"",location.pathname+location.search)});var d=/^#(\w+)(&.+)?/.exec(location.hash);if(d){var b=e[d[1]];if(b){b=b+(d[2]||"");b=b.replace("&","?");var f=function(){var g=c.data("tabs");if(g&&g.size()){g.hsOpen(b)}else{setTimeout(f,500)}};f(c)}}}jQuery.fn.hsPops=function(a){return this.hsBind(HsPops,a)};function HsVeil(a,b){this.sup=jQuery(a);this.sub=jQuery(b);this.sup.data("sub",b);this.sub.data("sup",a)}HsVeil.prototype={show:function(){if(this.sup.parent().size()===0){this.sup.insertBefore(this.sub);this.sub.detach()}},hide:function(){if(this.sub.parent().size()===0){this.sub.insertBefore(this.sup);this.sup.detach()}},toggle:function(){if(this.sup.parent().size()===0){this.show()}else{this.hide()}}};jQuery.fn.hsToggleInput=function(a){$(this).each(function(){var b=$(this).hsBind(HsVeil,function(){var c=$(this);var d=$(this).data("hsVeilNode");if(d===undefined){var e=$(this).data("hsVeilName");d=$('<input type="hidden">');d.attr("name",e||c.attr("data-fn")||c.attr("name")||c.find("[data-fn]").attr("data-fn")||c.find("[name]").attr("name"))}return d});if(a===undefined){b.toggle()}else{if(a){b.show()}else{b.hide()}}});return this};jQuery.fn.hsShowInput=function(){return this.hsToggleInput(true)};jQuery.fn.hsHideInput=function(){return this.hsToggleInput(null)};jQuery.fn.hsHideValue=function(g,b){g=hsSerialArr(g);var d=$('<input type="hidden">');if(!b){this.empty()}for(var c=0;c<g.length;c++){var f=g[c];var e=d.clone();e.attr("name",f.name);e.attr("value",f.value);e.appendTo(this)}return this};jQuery.fn.hsVeil=function(a){this.hsToggleInput(a!==undefined?!a:a)};jQuery.fn.hsHide=jQuery.fn.hsHideValue;function hsListFillSele(a,b,c){hsListFillFork.call(this,a,b,c);a.find("input").attr("title",this._info.name).data(this._info)}function hsListFillFilt(a,b,c){c=c.replace(/^ar\.\d\./,"");c=c.replace(/\.(\w\w)$/,"");b=this._info[c];return b}function hsListFeedFilt(h,j,b){b=b.replace(/^ar\.\d\./,"");b=b.replace(/\.(\w\w)$/,"");j=this._enfo[b];var d=h.attr("data-vk")||0;var l=h.attr("data-tk")||1;var c=h.find("[value='']").size()==0;if(c){for(var f=0;f<j.length;f++){var e=hsGetValue(j[f],d);if(e==""){c=false;break}}}if(c){var g=$.isArray(j)?[]:{};g[d]="";g[l]="";j.unshift(g)}return HsForm.prototype._feed__select.call(this,h,j,b)}function hsFillOpenLink(k,m,p){if(!m||!m.length){return}if(!$.isArray(m)){m=[m]}var c;switch(p){case"email":c="bi-hi-email";break;case"image":c="bi-hi-image";break;case"video":c="bi-hi-video";break;case"audio":c="bi-hi-audio";break;case"file":c="bi-hi-file";break;default:c="bi-hi-link";break}var j=$('<a><span class="'+c+'"></span></a>');var h=$('<a target="_blank"></a>');var d=$("<li></li>");var o=$("<ul></ul>");for(var g=0;g<m.length;g++){var f,b;if(p==="email"){b="mailto:"+m[g];f=m[g]}else{b=hsFixUri(m[g]);f=m[g].replace(/[?#].*/,"").replace(/.*\//,"");f=decodeURIComponent(f)}o.append(d.clone().append(h.clone().attr("href",b).text(f)))}k.addClass("dont-check");k.data("node",o);if(m.length>1){j.appendTo(k);j.attr("href","javascript:;");j.click(function(){var a=$.hsMask({title:"点击可打开..."});a.find(".modal-body").append(o);a.find(".modal-footer").remove()})}else{j.appendTo(k);j.attr("target","_blank");if(p==="email"){j.attr("href","mailto:"+m[0])}else{j.attr("href",hsFixUri(m[0]))}}}function hsListWrapOpen(a){return function(b,c){hsFillOpenLink(b,c,a)}}function hsFormWrapOpen(a){return function(b,c){hsFillOpenLink(b,c,a)}}function hsFillListMore(b,e){if(!e){return}var g=e;var i=b.data("title");var f=b.data("type");var h=$("<div></div>");var c=$('<a href="javascript:;"></ a>');if(!i){i=b.closest("td").index();i=b.closest("table").find("thead th,thead td").eq(i).text()}if(f==="html"){g=$("<div></div>").html(g).text();b.data("html",e)}else{b.data("text",e)}g=g.replace(/\s{2,}/g," ");g=$.trim(g);if(g.length>100){g=g.substr(0,100)+"..."}c.appendTo(h).text(g);h.appendTo(b).attr("title",g);h.css({overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap",width:"100%"});c.click(function(){if(f==="html"){$.hsMask({html:e,title:i,space:"pre-wrap"})}else{$.hsMask({text:e,title:i,space:"pre-wrap"})}})}function hsPickListMore(a,b){if(!b){b=a.closest(".HsList").data("HsList")}$.hsWarn("确定跨页全选吗?\r\n当数据量较大时, 可能需要些时间, 期间无法执行其他操作. 不设页码范围将选择所有页.",function(){var d=$(this).closest(".warnbox");var e=parseInt(d.find("[name=bn]").val()||-1);var c=parseInt(d.find("[name=qn]").val()||-1);if(e>c){d=e;e=c;c=d}setTimeout(function(){var f=$.hsWait("选择中, 请稍等...");hsListPickMore(b,e,c,-1,function(h,g){if(h!==g){f.prog(h/g,g<=0?"已选 "+h+"页":"已选 "+h+"页, 共 "+g+"页")}else{f.hide();var i=hsSerialMix({},b._url,b._data);h=parseInt(i[b.pageKey]||1);if(e<=c&&e<=h&&h<=c){b.load()}}})},0)},function(){}).find(".alert-footer").prepend('<div class="input-group pull-left" style="width: 300px"><span class="input-group-addon">页码范围, 从</span><input name="bn" type="number" min="1" class="form-control" /><span class="input-group-addon">到</span><input name="qn" type="number" min="1" class="form-control" /></div>')}function hsSaveListCols(d,h){var g=d.is("table")?d:d.find("table:first");var b=g.children("thead").children().children();var a=H$("%list-cols-"+h);if(a){a=a.split(",");for(var c=0;c<a.length;c++){var e=a[c];if(e){b.filter("[data-fn='"+e+"']").not(".dont-hide").addClass("hidden")}}}d.on("hideCols",function(){a=[];b.filter(".hidden").not(".dont-hide").each(function(){a.push($(this).data("fn"))});a=a.join(",");if(!a){a=null}H$("%list-cols-"+h,a)})}function hsHideListCols(c){var e=c.is("table")?c:c.find("table:first");var a=e.children("thead").children().children();var b=$('<form class="checkbox" onsubmit="return false"></form>');var d=$('<label><input type="checkbox" name="rb."><span></span></label>');a.each(function(){if($(this).is(".dont-hide,._admin,._check,._radio,._rowid")){return}var f=d.clone().appendTo(b);f.find("span").text($(this).text()||" ");f.find("input").val($(this).data("fn"));f.find("input").prop("checked",!$(this).is(".hidden"))});$.hsMask({title:"请选择要显示的列"},{label:"确定",glass:"btn-primary",click:function(){var f=e.children("thead,tbody,tfoot").children();b.find("input").each(function(){var g=$(this).prop("checked");var h=$(this).val();var i=a.filter('[data-fn="'+h+'"]').index();f.each(function(){$(this).children().eq(i).toggleClass("hidden",!g)})});c.trigger("hideCols")}},{label:"关闭",glass:"btn-default"},{label:"全选",glass:"btn-link pull-left",click:function(f){b.find(":checkbox").prop("checked",true);f.preventDefault();return false}},{label:"全否",glass:"btn-link pull-left",click:function(f){b.find(":checkbox").prop("checked",false);f.preventDefault();return false}}).find(".modal-body").append(b)}function hsCopyListData(j){if(!$.hsCanCopy()){$.hsWarn("浏览器无法拷贝\r\n请使用较新版的 Chrome/Firefox/Safari/Edge, 或某些双核/多核浏览器的极速模式.","warning");return}var m;var n=[{mode:"warn",glass:"alert-default",text:"这将整理原始数据, 清理表格中的内容, 提取完整的日期/时间, 补全图片/链接等网址, 以便导入 Office/WPS 等应用中.",title:"正在组织列表原始数据, 请稍等...",topic:"已经备好列表原始数据, 请拷贝吧!",note:"拷贝成功, 去粘贴吧!"},{glass:"btn-primary copies",label:"拷贝"},{glass:"btn-default",label:"取消"}];if(arguments.length>1){m=[].slice.call(arguments,1);m[0]=$.extend(n[0],m[0])}else{m=n}var c=$.hsMask.apply($,m);var q=function(){c.removeClass("alert-info").addClass("alert-success");c.find(".alert-footer .btn").prop("disabled",false);c.find(".alert-title").text(m[0].topic);return c};c.find(".alert-footer button").prop("disabled",true);c.find(".alert-footer button.copies").click(function(){c.prev().show().children().hsCopy();$.hsNote(m[0].note,"success")});var o=$("<div></div>").insertBefore(c);var b=$("<table></table>").appendTo(o);var h=$("<thead></thead>").appendTo(b);var g=$("<tbody></tbody>").appendTo(b);var a=$("<tr></tr>");var e=$("<th></th>");var f=$("<td></td>");o.attr("style","height: 1px; display: none; overflow: auto;");b.attr("style","margin: 1px; white-space: pre-line;");b.attr("class","table table-bordered table-copylist");if(j instanceof jQuery||j instanceof Element){j=$(j);j.find("thead:first tr").each(function(){var i=a.clone().appendTo(h);$(this).find("th").each(function(){var v=$(this);if(v.is(".dont-copy,._check,._admin,:hidden")){return}var u=e.clone().appendTo(i);u.text(v.text())})});j.find("tbody:first tr").each(function(){if(!$(this).is(".active")){return}var i=a.clone().appendTo(g);$(this).find("td").each(function(){var v=$(this);if(v.is(".dont-copy,._check,._admin,:hidden")){return}var u=f.clone().appendTo(i);if(v.data("node")){u.html(hsTidyHtmlTags(v.data("node")))}else{if(v.data("html")){u.html(hsTidyHtmlTags(v.data("html")))}else{if(v.data("text")){u.text(v.data("text"))}else{if(v.attr("title")){u.text(v.attr("title"))}else{u.html(hsTidyHtmlTags(v.html()))}}}}})});g.find("td").not(".numerial").attr("style","mso-number-format:'\\@';vnd.ms-excel.numberformat:'@';")}else{var k=j.cols||[];var r=j.list||[];var t=new HsList({context:o});t.listBox=b;var s=a.clone().appendTo(h);for(var p=1;p<k.length;p++){var l=e.clone().appendTo(s);var d=k[p];if(typeof d==="string"||typeof d==="number"){d={fn:d}}l.attr("class",d.glass);l.attr("style",d.style);l.text(d.label||"");l.data(d)}t.fillList(r);g.find("td").not(".numerial").attr("style","mso-number-format:'\\@';vnd.ms-excel.numberformat:'@';")}return q()}function hsTidyHtmlTags(a){if(!a){return""}if(typeof a==="number"){return a+""}if(typeof a==="object"){a=$(a).html()}a=a.replace(/\s+/gm," ");a=a.replace(/<\/?(p|br|hr|ul|ol|li|div|pre)(\/|\s.*?)?>/igm,"\r\n");return $.trim(a)}function hsSaveWithMemo(a){return function(){var c=arguments;var g=c[1];var e=this;var b=jQuery('<input type="text" name="memo" class="form-control" placeholder="选填, 请输入操作备注, 如: 补充简介信息"/>');var f=function(){delete e._waiting};var d=function(){g.append("memo",b.val());HsForm.prototype.save.apply(e,c)};if(a){this.warn(a,"default",d,f).find(".alert-body").append(b).trigger("shown.bs.modal")}else{d()}}}function hsSendWithMemo(c,g,b,f){var e=this;var a=jQuery('<input type="text" name="memo" class="form-control" placeholder="选填, 请输入操作备注, 如: 清理重复数据"/>');var d=function(){var h=jQuery.extend({},hsSerialDat(f),{memo:a.val()});var i=jQuery.extend({},hsSerialDat(b),hsSerialDat(f));e.ajax({url:b,data:h,type:"POST",dataType:"json",funcName:"send",cache:false,context:e,trigger:c,success:function(j){if(this.saveBack){this.saveBack(j)}else{this.sendBack(c,j,i)}}})};if(g){this.warn(g,"warning",d,null).find(".alert-body").append(a).trigger("shown.bs.modal")}else{d()}}function hsOpenThenLoad(d,e,c,f){var b=this.formBox;var a=this.loadBox;if(!b.reload){b.reload=function(){var g=a.data("href");var h=a.data("data");a.hsLoad(g,h)}}a.hsFind(e).hsOpen(c,f,function(){var g=jQuery(this);g.on("saveBack",function(h,j,i){b.trigger(h,[j,i]);if(h.isDefaultPrevented()){return}b.reload.apply(i,[])})})}function hsLoadWithWord(a,b){var c=this.context.find(".findbox [name=wd]").val();if(b&&c&&/^\?.+=/.test(c)){c=hsSerialDic(c);b=hsSerialDic(b);delete b.wd;b=hsSerialMix(b,c)}HsList.prototype.load.call(this,a,b)}function hsListFillLogo(b,a){if(!a){return}b.css({"background-size":"cover","background-repeat":"no-repeat","background-position":"center center","background-image":"url("+a+")"})}function hsListShowEdit(b,a){if(a){if(a.uid!==undefined){a=a.uid}else{if(a.id!==undefined){a=a.id}}}if(a&&a==H$.uid()){b.show()}}function hsListInitMine(a,b,d){var c=H$.uid();a.next().on("change",":radio",function(){switch($(this).val()){case"1":a.attr("name",d+".eq").val(c);break;case"2":a.attr("name",d+".ne").val(c);break;default:a.attr("name",d).val("");break}$(this).closest("label").siblings().find("input").prop("checked",false)})}function hsListInitSort(a,c,f){var d=a;var e=a.next().find("select").eq(0);var b=a.next().find("select").eq(1);b.addClass("invisible");a.next().change(function(){if(e.find("option").first().prop("selected")){b.find("option").first().prop("selected",true);b.toggleClass("invisible",true)}else{b.toggleClass("invisible",false)}if(b.val()==="-"){d.val(b.val()+e.val())}else{d.val(e.val()+b.val())}})}function hsFlexRoll(c,a,b,d){return $(c).hsRoll(a,b,d)}function hsDarkMode(h,g){var d=$(document.documentElement);if(window._HsDarkTime){clearInterval(window._HsDarkTime)}switch(h){case"2":if(!g||!/^\d{8}$/.test(g)){throw new Error("hsDarkMode: Wrong dark time format: "+g)}d.removeClass("dusk-mode");var a=g.substring(0,4);var f=g.substring(4,8);var j=a>f?function(b){return(b>=a||b<f)}:function(b){return(b>=a&&b<f)};function i(){var e=new Date();var c=e.getHours();var b=e.getMinutes();if(j((c*100)+(b<10?b*10:b))){d.addClass("dark-mode")}else{d.removeClass("dark-mode")}}i();window._HsDarkTime=setInterval(i,60000);break;case"1":d.removeClass("dusk-mode").addClass("dark-mode");break;case"0":d.removeClass("dark-mode").addClass("dusk-mode");break;default:d.removeClass("dark-mode").removeClass("dusk-mode");break}}(function(a){if(!a(document.documentElement).hasClass("deny-dark")){hsDarkMode(H$("%HsDarkMode")||"0",H$("%HsDarkTime")||"18000600")}a(document).on("click",".cancel,.recant",function(){var c=a(this).closest(".dont-close").hsFind("@");var b=a(this).hsFind("@");if(c!=b){b.hsClose()}});a(document).on("reset",".HsList .findbox",function(){var b=a(this);b.find("[data-ft=_fork]").each(function(){hsFormFillFork(a(this),{})});b.find("[data-fn].repeated.labelbox   .label").remove();b.find("[data-fn].bootstrap-tagsinput .label").remove();setTimeout(function(){b.find(":submit").first().click()},500)})})(jQuery);
