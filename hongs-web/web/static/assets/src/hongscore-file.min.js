(function(a){a.fn.hsPickFile=function(f,g){if(!g){return}a(this).before(a(this).clone().val(""));f=a(f);var b=/^data:/.test(g)?"":decodeURIComponent(g.replace(/^.*[\/\\]/,""));var c=f.is(".pickrol")?"btn-link":"btn-info";var d=a("<span></span>").text(b);var e=a(this);var h=a('<li class="btn '+c+' form-control" ></li>').attr("title",b).append('<span class="close pull-right"      >&times;</span>').append('<span class="glyphicon glyphicon-open-file"></span>').append(d).append(e);f.append(h);return h};a.fn.hsFillFile=function(g,h){if(!h){return}var f=a(this);var b=/^data:/.test(h)?"":decodeURIComponent(h.replace(/^.*[\/\\]/,""));var c=f.is(".pickrol")?"btn-link":"btn-info";var d=a("<span></span>").text(b);var e=a('<input  type="hidden" />').attr("name",g).val(h);var i=a('<li class="btn '+c+' form-control" ></li>').attr("title",b).append('<span class="close pull-right"      >&times;</span>').append('<span class="glyphicon glyphicon-save-file"></span>').append(d).append(e);f.append(i);return i};a.fn.hsPickView=function(i,b,m,j,e){if(!b){return}a(this).before(a(this).clone().val(""));i=a(i);var l=a(this);var g=/^data:/.test(b)?"":decodeURIComponent(b.replace(/^.*[\/\\]/,""));var d=a('<li class="preview"></li>').attr("title",g).css({width:m+"px",height:j+"px",overflow:"hidden"});var c;if(!e){c=function(){var k=this.width;var o=this.height;var n=a(this);n.css({top:"0px",left:"0px"});d.css({width:k+"px",height:o+"px"})}}var f=e==="pick"?a.hsPickSnap(b,m,j,c):a.hsKeepSnap(b,m,j,c);d.append(l).append(f).append('<a href="javascript:;" class="close">&times;</a>');i.append(d);return d};a.fn.hsFillView=function(g,b,n,l,e){if(!b){return}var j=a(this);var m=a('<input  type="hidden" />').attr("name",g).val(b);var i=/^data:/.test(b)?"":decodeURIComponent(b.replace(/^.*[\/\\]/,""));var d=a('<li class="preview"></li>').attr("title",i).css({width:n+"px",height:l+"px",overflow:"hidden"});var c;if(!e){c=function(){var k=this.width;var p=this.height;var o=a(this);o.css({top:"0px",left:"0px"});d.css({width:k+"px",height:p+"px"})}}var f=e==="pick"?a.hsPickSnap(b,n,l,c):a.hsKeepSnap(b,n,l,c);d.append(m).append(f).append('<a href="javascript:;" class="close">&times;</a>');j.append(d);return d};a.fn.hsReadFile=function(b){this.each(function(){var c=this;if(this.files){if(window.FileReader){a.each(this.files,function(f,e){var d=new FileReader();d.onloadend=function(g){b.call(c,e,g.target.result)};d.readAsDataURL(e)})}else{a.each(this.files,function(e,d){b.call(c,d,d.getAsDataURL())})}}else{b.call(c,null,c.value)}});return this};a.hsPickSnap=function(g,d,f,c){var e=new Image();e.onload=function(){var i=e.width;var h=e.height;var b=h*d/f;if(b>i){e.width=d;e.height=h*d/i;a(e).css("top",(((f-e.height)/2))+"px")}else{e.height=f;e.width=i*f/h;a(e).css("left",(((d-e.width)/2))+"px")}if(c){c.call(e)}};e.src=g;return a(e)};a.hsKeepSnap=function(g,d,f,c){var e=new Image();e.onload=function(){var i=e.width;var h=e.height;var b=h*d/f;if(b<i){e.width=d;e.height=h*d/i;a(e).css("top",(((f-e.height)/2))+"px")}else{e.height=f;e.width=i*f/h;a(e).css("left",(((d-e.width)/2))+"px")}if(c){c.call(e)}};e.src=g;return a(e)};a(document).on("click","[data-toggle=hsFile]",function(){var c=a(this).siblings(":file");if(!c.data("picked")){c.data("picked",1);var b=c.siblings(".pickbox");c.on("change",function(){_hsSoloFile(b,false);c.hsPickFile(b,c.val())})}c.click()});a(document).on("click","[data-toggle=hsView]",function(){var g=a(this).siblings(":file");if(!g.data("picked")){g.data("picked",1);var f=g.siblings(".pickbox");var i=g.prop("multiple");var c=f.data("mode");var b=f.data("size");var e=b.split("*",2);b=e[0];e=e[1];var d=a('<input type="hidden"/>').attr("name",g.attr("name"));g.on("change",function(){g.hsReadFile(function(k,j){_hsSoloFile(f,false);if(i){var h=g.clone();h[0].filez=[k];h.val("");g.val("");h.hsPickView(f,j,b,e,c)}else{g.hsPickView(f,j,b,e,c)}setTimeout(function(){d.remove()},100)});f.append(d)})}g.click()});a(document).on("click","ul.pickbox li",function(b){var e=a(this).closest(".pickbox");if(e.siblings("[data-toggle=hsFile],[data-toggle=hsView]").size()==0){return}if(a(b.target).is(".close")){a(this).remove();e.trigger("change");_hsSoloFile(e,true);return}var d=a(this).find("input");if(d.attr("type")!="file"){var c=hsFixUri(d.val());if(c){window.open(c,"_blank")}}})})(jQuery);function _hsSoloFile(c,a){var b=c.data("fn");if(!b||c.hasClass("pickmul")){return}if(!c.data("repeated")&&!c.data("multiple")&&!/(\[\]|\.\.|\.$)/.test(b)){c.siblings("[data-toggle=hsFile],[data-toggle=hsView]").toggle(a);c.removeClass("pickmul")}else{c.addClass("pickmul")}}function hsFormFillFile(b,a,c){if(!a){return}if(!jQuery.isArray(a)){a=[a]}if(a.length){_hsSoloFile(b,false)}jQuery.each(a,function(e,d){b.hsFillFile(c,d)})}function hsFormFillView(e,c,f){if(!c){return}if(!jQuery.isArray(c)){c=[c]}if(c.length){_hsSoloFile(e,false)}var b=e.data("mode");var a=e.data("size");var d=a.split("*",2);a=d[0];d=d[1];jQuery.each(c,function(h,g){e.hsFillView(f,g,a,d,b)})};